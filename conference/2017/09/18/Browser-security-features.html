<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Browser Security Features - Tim De Grande">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/security/padlock_code.jpg"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/conference/2017/09/18/Browser-security-features.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Browser Security Features - Tim De Grande"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/security/padlock_code.jpg"/>

    
    <title>Browser Security Features - Tim De Grande &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="https://join.ordina-jworks.io/">JOIN</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>Browser Security Features</h2>
                

                
                    Posted Sep 18, 2017


    in <a href="/categories/security/">Security</a>



    by
    
        <a href="/author/tim-de-grande/">Tim De Grande</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/security/">Security</a>, 
    
        <a href="/tags/browser-features/">Browser features</a>, 
    
        <a href="/tags/response-headers/">Response headers</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <h1 id="browser-security-features">Browser security features</h1>

<p><strong>Update</strong>: due to the deprecation of HPKP, we’ve posted an <a href="/security/2018/02/12/HPKP-deprecated-what-now.html">update</a> to this blog post.</p>

<p>Browsers nowadays come with a ton of security features built-in.
These features are there to protect the people using your application as well as protecting your application from malicious others.
Most of these features are quite easy to implement, however for some of them (such as key-pinning) you have to be careful not to break your site.
It’s this danger, combined with the lack of knowledge, that prevents people from taking full advantage of them.</p>

<h2 id="table-of-contents">Table of contents</h2>
<ol>
  <li><a href="#transport-layer-security">Transport Layer Security</a></li>
  <li><a href="#http-strict-transport-security">HTTP Strict Transport Security</a></li>
  <li><a href="#public-key-pinning">Public Key Pinning</a></li>
  <li><a href="#content-security-policy">Content Security Policy</a></li>
  <li><a href="#subresource-integrity">Subresource Integrity</a></li>
  <li><a href="#cookie-protection">Cookie Protection</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<h2 id="transport-layer-security">Transport Layer Security</h2>
<p>The first layer of defense is not a new one at all: Transport Layer Security (TLS).
TLS is sometimes (incorrectly) referred to as SSL (Secured Socket Layer). 
In reality SSL is an obsolete technology, with TLS being its successor, but the name stuck.</p>

<p>Having said this, why should you use TLS? 
First of all, most of the features described below <em>only</em> work when you’re on a secured connection.
Besides that, it guarantees the end user that the site they’re communicating with is actually the site they think it is.
It also provides the guarantee that the content they see was not tampered with while travelling over the network.</p>

<p>Another thing TLS brings to the table is speed: it used to be true that a secure connection was slower than an unsecured one.
Modern hardware however is more than up to the task of handling this efficiently for you.
Besides that, HTTP/2 is <em>only</em> available over a secure connection and it allows for faster page loads.
Have a look at <a href="http://www.httpvshttps.com/" target="_blank">HTTP vs HTTPS</a> for a demo of the difference.</p>

<p>Since speed should no longer prevent you from switching to HTTPS, there’s only cost.
Even that is no longer true: a simple <a href="https://en.wikipedia.org/wiki/Domain-validated_certificate" target="_blank">Domain Validation</a> certificate can be obtained for free.
But even if you need more protection, an <a href="https://en.wikipedia.org/wiki/Extended_Validation_Certificate" target="_blank">Extended Validation</a> certificate can be had for as little as $300 per year.</p>

<h3 id="how-hard-is-it">How hard is it?</h3>
<p>The main issue is that all resources you use on your site should be served over HTTPS.
This means that all third parties should use TLS as well.
Furthermore, it depends on the complexity of your site.
Nick Craver wrote an extensive <a href="https://nickcraver.com/blog/2017/05/22/https-on-stack-overflow/" target="_blank">blog post</a> on their road to switching to HTTPS.</p>

<h3 id="should-you-activate-this-on-your-site">Should you activate this on your site?</h3>
<p>Absolutely! 
Modern browsers are shifting from notifying users that a page is secure to warning them that it isn’t.
On top of that, Google gives a slight ranking boost to HTTPS sites.</p>

<h2 id="http-strict-transport-security">HTTP Strict Transport Security</h2>
<p>Once your server is properly configured to use TLS, your next step is to redirect your users to the secure version.
You could do this by simply adding a redirect-rule in your web server for the non-secure pages.
This means that users will still first connect to your non-secure site, allowing a potential attacker to intercept the request and do his nefarious deeds.
Wouldn’t it be nice if you could tell the browser to just go straight to the secure version?
That’s the thinking behind the HSTS (HTTP Strict Transport Security) header.</p>

<p>HSTS simply tells the browser that you’re expecting it to use HTTPS for a certain time.
As a result, the browser will <em>automatically</em> replace <code class="language-plaintext highlighter-rouge">http://</code> with <code class="language-plaintext highlighter-rouge">https://</code> <strong>before</strong> making the call.
This means that even following a link that explicitly defines <code class="language-plaintext highlighter-rouge">http://</code> will instead be called using a secure connection.</p>

<p>The configuration of HSTS is as easy as can be: you simply add the following header to your response:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Strict-Transport-Security: max-age=31536000; includeSubDomains
</code></pre></div></div>

<p>This will tell the browser that for the next 365 days, it should connect to your domain using HTTPS.
The <code class="language-plaintext highlighter-rouge">includesubdomains</code> directive tells the browser that your subdomains should also be called using https.
Setting the <code class="language-plaintext highlighter-rouge">max-age</code> to 0 tells the browser that you no longer wish your domain to be HSTS-enabled.</p>

<h3 id="hsts-preload">HSTS preload</h3>
<p>Of course in this scenario, the user’s first connection will still take place over an unsecured connection.
This would offer an attacker a brief period in which he can still hijack the connection.
To prevent this, most major browsers (Chrome, Firefox, Safari, Edge, IE11 and Opera) offer an HSTS preload list.
Domains on this list will automatically be loaded over HTTPS from the start, without having to go through the HTTP -&gt; HTTPS redirect.
If you want your domain to be included in this list, you should add the <code class="language-plaintext highlighter-rouge">preload</code> directive to the HSTS header.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Strict-Transport-Security: max-age=31536000; includeSubDomains; preload
</code></pre></div></div>

<p>Afterwards, you can register yourself for the <a href="https://hstspreload.org/" target="_blank">HSTS Preload List</a>.</p>

<h3 id="are-there-any-risks">Are there any risks?</h3>
<p>Activating HSTS does offer some risks:</p>
<ul>
  <li>If you include the <code class="language-plaintext highlighter-rouge">includesubdomains</code> directive, you tell the browser that <em>all</em> subdomains need to be retrieved over HTTPS.
If your internal applications are on a subdomain (e.g. <code class="language-plaintext highlighter-rouge">internal.example.com</code>), you’ll block access to those that haven’t enabled TLS yet.</li>
  <li>Adding the <code class="language-plaintext highlighter-rouge">preload</code> directive is even more dangerous because this tells browser makers to hardcode your HSTS settings.
If you’ve made a mistake in the setup, it can take a long time to be removed from the list. 
Since this list is <em>in</em> the browser, you’ll affect both your existing and your new users.
These risks can be mitigated through extensive testing and conservative settings. 
Start with a short <code class="language-plaintext highlighter-rouge">max-age</code> and slowly increase its length, don’t include subdomains if you’re not 100% sure that <em>all</em> subdomains need to be included
and perhaps most importantly, <strong>don’t</strong> activate preload unless you’re 100% sure that everything works as intended.</li>
</ul>

<h3 id="should-i-activate-hsts">Should I activate HSTS?</h3>
<p>For those (subdomains) where TLS is enabled, you should start rolling out HSTS (while keeping in mind the warnings above).</p>

<h2 id="public-key-pinning">Public key pinning</h2>
<p><strong>Update</strong>: HPKP is deprecated from Chrome 67, have a look at <a href="/security/2018/02/12/HPKP-deprecated-what-now.html">this post</a> to see what next.</p>

<p>Alright, now you’ve secured your site with HTTPS, and you’ve made sure your users can’t fall victim to a Man in the Middle attack.
Or have you?
It’s true that HSTS will make sure that the user only connects using a secured connection, but that doesn’t mean the HTTPS connection is actually made to <strong>your</strong> server.
Over the last couple of years, there were several incidents where malicious actors were able to generate valid certificates for domains they didn’t control.
When this happens, your users will think they’re safe (as their browser shows the green padlock), but the attacker can still manipulate your content.
To protect yourself against this, there’s a mechanism called “HTTP Public Key Pinning” (HPKP [<a href="#fn1">1</a>]).
With HPKP you “pin” the public key of your TLS certificate to the browser.
In the future, that browser will compare the public key that’s actually used for the TLS connection, with the pinned one and, if they don’t match, refuse the connection altogether.
<img src="/img/2017-security-features/hpkp-error.png" alt="HPPK error" class="image" height="245px" /></p>

<p>An HPKP header looks like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public-key-pins:pin-sha256="YLh1...uihg=";pin-sha256="9dNi...Dwg=";pin-sha256="Vjs...eWys=";max-age=2592000;includeSubdomains;report-uri="report-uri"
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">max-age</code> directive tells the browser for how long these pins are valid. 
You can use <code class="language-plaintext highlighter-rouge">report-uri</code> to get a report when an invalid certificate is used.
<code class="language-plaintext highlighter-rouge">includesubdomains</code> makes sure that the policy also applies to your subdomains.
Finally, there are the actual pins.
You need to pin at least 2 fingerprints: 1 that should be active at the moment and 1 that isn’t.</p>

<h3 id="what-to-pin">What to pin?</h3>
<p>First of all, you need to pin at least one of the keys in your certificate chain.
While you can pin the key of the actual certificate, that might not be the best idea.
Doing this means that you need to update the keys every time your certificate is changed or you will risk your users being unable to visit your site.
Alternatively, you could pin the key for the root certificate of your CA (Certificate Authority).
While this is a lot safer, it does mean that if your CA, or any of its intermediates is compromised, they could issue valid certificates for your site.
Finally, you have the option to pin the key to the intermediate certificate. 
Doing so limits the attack surface to that intermediate, while it also allows you to roll out new certificates whenever you need to.
Of course you can’t control when your CA will change their intermediate certificate, so that’s a danger in its own.</p>

<p>Besides that you also need to have a second key pinned that’s <em>not</em> in your current certificate chain, otherwise your HPKP header will be ignored.
Fortunately, you don’t have to have certificates ready for this.
It’s enough to pin the public key of a CSR (Certificate Signing Request).
Obviously, you can’t use the CSR of your current certificate (as that would be valid for this chain), so you’ll need to create a backup CSR.
You’ll need to keep this CSR and the associated private key in a secure location, because you don’t want these to be compromised together with the original.</p>

<h3 id="report-uri">report-uri</h3>
<p>The <code class="language-plaintext highlighter-rouge">report-uri</code> directive is used to tell the browser where to send reports if it encounters an invalid certificate.
The browser will POST a JSON message to the URL you specify here.
If you don’t want to implement your own processing of these reports, have a look at <a href="https://report-uri.io/" target="_blank">report-uri.io</a>
It will process the reports from your site and display the results in a nice format, allowing you to take action when you see something that’s wrong.</p>

<h3 id="report-only">Report-only</h3>
<p>Besides the normal HPKP header, there’s also the report-only variant: <code class="language-plaintext highlighter-rouge">Public-Key-Pins-Report-Only</code>.
This header has the exact same specifications, <strong>but</strong> it won’t block access to your site if there’s no valid pin.
As the name says, it will simply report violations to the <code class="language-plaintext highlighter-rouge">report-uri</code>.
Obviously, this header isn’t meant to increase the security of your site on its own, rather it’s a way to help you on your way to a full HPKP implementation.</p>

<h3 id="dangers">Dangers</h3>
<p>HPKP is quite a dangerous header: it’s quite easy to commit “pinning-suicide”.
Pin the wrong certificate, have a CA change keys on you or have something else go wrong and your site is inaccessible until your users’ <code class="language-plaintext highlighter-rouge">max-age</code> expires.
Be careful rolling out this one as it’s way too easy to shoot yourself in the foot.</p>

<h3 id="should-i-use-it">Should I use it?</h3>
<p>This header has some serious dangers associated with it.
It’s not enough to know that the current configuration is correct, you also need to be sure that you’re equipped to deal with certificate updates without breaking the site.
And then you need to be sure that you’ve got a backup in place in case you ever want to switch CAs.
Unless you’re 100% sure that this won’t be an issue, hold off for now as it’s too easy to DoS your own site.</p>

<h2 id="content-security-policy">Content Security Policy</h2>
<p>Even though your connection is secured with TLS, that doesn’t mean that the content can’t be tampered with in other ways (such as cross-site scripting (XSS)).
An attacker could use these kinds of attacks to load malicious content.
The Content Security Policy (CSP) header is designed to prevent this kind of attacks.
It allows you to specify exactly what content your site is allowed to load through a load of directives.</p>

<h3 id="fetch-directives">Fetch directives</h3>
<p>First of all, you can define what source content can be fetched from. 
There’s a specific directive for each resource type and a fallback directive <code class="language-plaintext highlighter-rouge">default-src</code>.
You define the sources where the content can be loaded from as follows:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">self</code> only load content from the same origin as the page</li>
  <li><code class="language-plaintext highlighter-rouge">none</code> don’t load any content of this type</li>
  <li><code class="language-plaintext highlighter-rouge">unsafe-inline</code> lets you use inline javascript and CSS (although it’s preferable to use a nonce)</li>
  <li><code class="language-plaintext highlighter-rouge">unsafe-eval</code> allows the use of <code class="language-plaintext highlighter-rouge">eval()</code>, <code class="language-plaintext highlighter-rouge">setTimeout(String)</code>, <code class="language-plaintext highlighter-rouge">setInterval(String)</code> and <code class="language-plaintext highlighter-rouge">new Function(String)</code>.
 There’s a reason it has “unsafe” in its name though: these functions are typically used as attack vectors for XSS.</li>
  <li><code class="language-plaintext highlighter-rouge">https:</code> allow content loaded from anywhere, as long as it’s served over HTTPS</li>
  <li><code class="language-plaintext highlighter-rouge">example.com</code> allow content loaded from anywhere on <code class="language-plaintext highlighter-rouge">example.com</code>, both HTTP and HTTPS</li>
  <li>You can also use wildcards to control which origins are allowed. 
 E.g. <code class="language-plaintext highlighter-rouge">*://*.example.com:*</code> will allow resources to be loaded from all <em>subdomains</em> of <code class="language-plaintext highlighter-rouge">example.com</code>, using any scheme and port.
 Note that it won’t allow you to load resources from <code class="language-plaintext highlighter-rouge">example.com</code> itself.</li>
  <li><code class="language-plaintext highlighter-rouge">nonce-...</code> Allows you to specify a <a href="#nonce">nonce</a>. Scripts or styles that have this nonce are then allowed to execute.
It’s also important to note that you can pass multiple values to these directives: <code class="language-plaintext highlighter-rouge">self https://example.com</code> will allow resources to be loaded both from the domain itself as well as from <code class="language-plaintext highlighter-rouge">https://example.com</code>.</li>
</ul>

<p>You can use these to define <code class="language-plaintext highlighter-rouge">default-src</code>, but CSP gives you more fine-grained control over where each type of resource can be loaded from.
For that you need to use the following properties instead:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">script-src</code> - Javascript</li>
  <li><code class="language-plaintext highlighter-rouge">style-src</code> - CSS</li>
  <li><code class="language-plaintext highlighter-rouge">img-src</code> - images</li>
  <li><code class="language-plaintext highlighter-rouge">font-src</code> - fonts</li>
  <li><code class="language-plaintext highlighter-rouge">object-src</code> - objects (e.g. <code class="language-plaintext highlighter-rouge">&lt;object&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;embed&gt;</code>, …)</li>
  <li><code class="language-plaintext highlighter-rouge">media-src</code> - media such as <code class="language-plaintext highlighter-rouge">&lt;audio&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;video&gt;</code> elements</li>
  <li><code class="language-plaintext highlighter-rouge">connect-src</code> - where the page can connect to using <code class="language-plaintext highlighter-rouge">XmlHttpRequest</code>, <code class="language-plaintext highlighter-rouge">WebSocket</code> or <code class="language-plaintext highlighter-rouge">EventSource</code>.
 The browser will immediately return a 400 status code when your page attempts to connect to a non-valid domain.</li>
  <li><code class="language-plaintext highlighter-rouge">frame-src</code> - Specify which locations can be embedded in a <code class="language-plaintext highlighter-rouge">&lt;frame&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code></li>
  <li><code class="language-plaintext highlighter-rouge">worker-src</code> - Worker scripts</li>
  <li><code class="language-plaintext highlighter-rouge">child-src</code> - Is either deprecated or serves as fallback for <code class="language-plaintext highlighter-rouge">frame-src</code> and <code class="language-plaintext highlighter-rouge">worker-src</code>, depending on the browser and the CSP level implemented.</li>
  <li><code class="language-plaintext highlighter-rouge">manifest-src</code> - defines which <a href="https://developer.mozilla.org/en-US/docs/Web/Manifest" target="_blank">manifest</a> can be applied to the resource. (This is still experimental though).</li>
</ul>

<h3 id="navigation-directives">Navigation directives</h3>
<p>These directives tell the browser what kind of navigation is allowed:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">form-action</code> limits to where forms can be submitted</li>
  <li><code class="language-plaintext highlighter-rouge">frame-ancestors</code> specifies who may embed pages using elements such as <code class="language-plaintext highlighter-rouge">&lt;frame&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;embed&gt;</code>, <code class="language-plaintext highlighter-rouge">&lt;object&gt;</code> and <code class="language-plaintext highlighter-rouge">&lt;applet&gt;</code></li>
</ul>

<h3 id="other-directives">Other directives</h3>
<p>Besides these, CSP allows for quite a few other directives:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">report-uri</code> works the same way as the <code class="language-plaintext highlighter-rouge">report-uri</code> directive of HPKP</li>
  <li><code class="language-plaintext highlighter-rouge">require-sri-for</code> allows you to force the use or Subresource Integrity ((SRI)[#Subresource-integrity]) for stylesheets, scripts or both. 
 Allowed values are <code class="language-plaintext highlighter-rouge">script</code> and <code class="language-plaintext highlighter-rouge">style</code> (or both).</li>
  <li><code class="language-plaintext highlighter-rouge">base-uri</code> defines which URLs you can use in the <code class="language-plaintext highlighter-rouge">&lt;base&gt;</code> element</li>
  <li><code class="language-plaintext highlighter-rouge">sandbox</code> to enable a sandbox for requested resources 
 (have a look at <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox" target="_blank">Mozilla’s documentation</a> for more information)</li>
</ul>

<h3 id="nonce">Nonce</h3>
<p>A nonce, pronounced “/nɒns/” (nance), is a term that means “number (used) once”.
It allows you to load specific inline scripts without allowing all of them. 
Only those scripts that have a nonce attribute that matches the value specified in the CSP header will get executed.
Keep in mind though that you should <strong>never</strong> hardcode the nonce or use a value that can be guessed.
It’s best to generate a new nonce for each request and add it to those scripts you need to execute.
E.g. if you have the following CSP setting:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Content-Security-Policy: script-src 'nonce-randomValue'
</code></pre></div></div>

<p>will only execute scripts that have the nonce attribute defined like this:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">nonce=</span><span class="s">"randomValue"</span><span class="nt">&gt;</span>
    <span class="c1">// ... script contents</span>
<span class="nt">&lt;/script&gt;</span></code></pre></figure>

<h3 id="multiple-policies">Multiple policies</h3>
<p>You are allowed to specify multiple CSP policies simply by specifying the header multiple times.
If you do this however, it’s important to keep in mind that subsequent CSPs are not allowed to loosen the rules, only to tighten them.</p>

<h3 id="report-only-1">Report-only</h3>
<p>As with HPKP, CSP also supports a report-only variant with <code class="language-plaintext highlighter-rouge">Content-Security-Policy-Report-Only</code>.
Once again the specifications are exactly the same but it won’t block loading or execution of disallowed resources and simply report violations.
You can then use the reports it generates to decide what you need to allow in your actual CSP header, before you deploy it (and break your site).</p>

<h3 id="should-i-use-it-1">Should I use it?</h3>
<p>CSP has some risks: it can break your site’s functionality, but overall it’s relatively easy to test it. 
The <code class="language-plaintext highlighter-rouge">report-uri</code> directive allows you to monitor if there are any issues and you can use the report-only version of the header to easily validate the setup you’re planning in the wild.
If you have a system that relies a lot on third party content, it might not be for you.
For everyone else, try out the report-only header and see if you get any issues.</p>

<h2 id="subresource-integrity">Subresource integrity</h2>
<p>When you’re developing a web application, you’ll often depend on some JavaScript frameworks such as Angular or jQuery.
Loading these files from a CDN can speed up load times from your application, since it’s quite likely that the user already has a cached version of the script available.
Of course it’s a good idea to be careful about the content of these scripts.
Whenever you’re loading resources that aren’t under your control, you’re depending on someone else to make sure that they aren’t tampered with.
To make sure that they aren’t changed without your knowledge, you can use subresource integrity (SRI).
With SRI, you add an <code class="language-plaintext highlighter-rouge">integrity</code> attribute to your <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> or <code class="language-plaintext highlighter-rouge">&lt;link&gt;</code> tag.
This attribute contains the hash of the file you expect.
Your browser will then download the file, hash it with the same algorithm and compare the results.
If the hash matches, the resource will be used; otherwise it will be ignored and an error will be shown in the console.</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"</span> 
    <span class="na">integrity=</span><span class="s">"sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="</span> 
    <span class="na">crossorigin=</span><span class="s">"anonymous"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>As you can see in the example above, the integrity of the script will be checked using a ‘SHA256’ hash. 
You’ll also notice the <code class="language-plaintext highlighter-rouge">crossorigin</code> attribute: this attribute is required when loading SRI validated resources from a different origin.
Possible values are <code class="language-plaintext highlighter-rouge">use-credentials</code> and <code class="language-plaintext highlighter-rouge">anonymous</code>, indicating whether a request will have the credentials flag set.
If you’re using a CDN, you’ll probably want to use <code class="language-plaintext highlighter-rouge">anonymous</code>.
Note that you only need to add the <code class="language-plaintext highlighter-rouge">crossorigin</code> attribute if you’re loading the resource from a different origin.
For resources coming from the same origin, you can omit the <code class="language-plaintext highlighter-rouge">crossorigin</code> attribute.</p>

<h3 id="calculating-the-sri-value">Calculating the SRI value.</h3>
<p>In order to add the <code class="language-plaintext highlighter-rouge">integrity</code> attribute, you need to know the correct hash of the file. 
The easiest way to calculate it is by simply specifying a random value and checking the resulting error in your browser.
<img src="/img/2017-security-features/integrity-error.png" alt="Chrome SRI error" class="image" height="50px" /></p>

<h3 id="should-i-use-it-2">Should I use it?</h3>
<p>Most likely. 
If you’re depending on third party scripts, you should make sure that they aren’t changed without your knowledge.
This does mean that you shouldn’t just include the latest version of a script (e.g. <code class="language-plaintext highlighter-rouge">example.com/library/latest/</code>) as that will change whenever a new version is released.</p>

<h2 id="cookie-protection">Cookie protection</h2>
<p>Most websites nowadays use a variety of cookies for different purposes.
These too can be a source of problems: session cookies grant the user access to certain content or allow them to perform certain actions.
If this cookie can be intercepted or altered, the consequences can be enormous.
Because of this, it’s a good idea to protect your cookies as much as possible.
Since you’re already running your site on HTTPS, it’s a good idea to make sure the cookies aren’t sent on insecure requests.
You can easily do this by adding the <code class="language-plaintext highlighter-rouge">secure</code> flag to the cookies you send.</p>

<p>To make the cookies even more secure, you’ll also need to prevent them from being read/modified by scripts running in the page.
In most cases there’s no reason for a script to have access to these cookies, so you can simply mark them as <code class="language-plaintext highlighter-rouge">HttpOnly</code>.</p>

<h3 id="should-i-use-this">Should I use this?</h3>
<p>Yes.
Your session cookies should not be available to scripts, so the <code class="language-plaintext highlighter-rouge">HttpOnly</code> flag should be set on those.
If you’re using TLS (and you should) you should definitely set the <code class="language-plaintext highlighter-rouge">secure</code> flag as well.</p>

<h2 id="conclusion">Conclusion</h2>
<p>Browsers nowadays support a wide array of security features you can use to keep your users safe.
But, as with all things, powerful tools require you to wield them carefully.
If you apply them without proper thought, you can easily make your website inaccessible or render it unusable.
Because of that, you need to be really careful when you implement (most of) these measures.
Do proper testing and (where possible) use the Report-Only variant for a while to spot possible issues before they become real problems.
Make sure you really understand what you’re doing and what the consequences are of getting things wrong.
When you have all that, don’t be afraid to experiment, just make sure you do so safely.</p>

<p><a name="fn1"></a>[1] <a href="http://ordina-jworks.github.io/spring/2016/03/05/HTTP-Public-Key-Pinning-with-Spring-Security.html">Public Key Pinning with Spring Security</a></p>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/conference/2017/09/18/Browser-security-features.html&title=Browser Security Features&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=Browser Security Features&url=https://ordina-jworks.github.io/conference/2017/09/18/Browser-security-features.html&via=lifeatordinabe&related=lifeatordinabe" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/conference/2017/09/18/Browser-security-features.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/tim-de-grande/" class="image spotlight-image" title="">
            <img src="/img/author/tim-de-grande.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Tim is a principal Java Consultant at Ordina who is interested in security, cryptography and privacy. As Compentence Leader Application Security, he keeps his colleagues up to date on the latest security news and works to broaden their understanding by giving workshops and classes.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://twitter.com/lifeatordinabe" target="_blank">
                <i class="fa fa-fw fa-twitter"></i><span>Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2023 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/security/padlock_code.jpg";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
