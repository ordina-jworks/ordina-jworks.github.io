<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="DockerCon 2016 - What is new in Docker 1.12 - Tom Verelst">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/dockercon/dockercon.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/conference/2016/06/20/whats-new-in-docker-112.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="DockerCon 2016 - What is new in Docker 1.12 - Tom Verelst"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/dockercon/dockercon.png"/>

    
    <title>DockerCon 2016 - What is new in Docker 1.12 - Tom Verelst &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>DockerCon 2016 - What is new in Docker 1.12</h2>
                

                
                    Posted Jun 20, 2016


    in <a href="/categories/conference/">Conference</a>



    by
    
        <a href="/author/tom-verelst/">Tom Verelst</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/dockercon/">DockerCon</a>, 
    
        <a href="/tags/docker/">Docker</a>, 
    
        <a href="/tags/conference/">Conference</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <p><img class="image fit" src="/img/dockercon/dockercon.png" alt="DockerCon 2016" /></p>

<h2 id="orchestration-made-easy">Orchestration Made Easy</h2>

<p>Last week,
I tried out the new orchestration tools that were <a href="https://github.com/docker/swarmkit">made available on GitHub</a>.
My first impressions were very positive.
The setup is easy and it works like a charm.
Today,
at DockerCon 2016,
these new orchestration tools were officially announced during the opening session.
There is also an <a href="https://blog.docker.com/2016/06/docker-1-12-built-in-orchestration/">official blog post</a>.</p>

<p>Before we start talking about orchestration,
let’s take a step back and look at how easy it has become to set up a Swarm cluster.</p>

<p>Creating a Swarm manager can be done with one simple command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker swarm init
</code></pre></div></div>

<p>You can run this command on any Docker 1.12 host.</p>

<p>After we created the Swarm manager,
we can add additional nodes to the swarm by running the following command on other Docker hosts:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker swarm <span class="nb">join</span> &lt;IP of manager&gt;:2377
</code></pre></div></div>

<p>That’s it.
No messing around with key-value stores or certificates.
Docker will automatically configure everything you need out-of-the-box.</p>

<p>Under the hood,
Docker uses a <a href="https://raft.github.io/raft.pdf">Raft</a> consensus.</p>

<p>There are two types of nodes: <strong>manager</strong> and <strong>worker</strong>.
The first initial node is a manager.
When adding more nodes to the Swarm,
these nodes will be worker nodes by default.</p>

<p><img class="image fit" src="/img/dockercon/swarm-overview.png" alt="Overview" /></p>

<p>Manager nodes are responsible for managing the cluster’s desired state.
They do health checks and schedule tasks to keep this desired state.</p>

<p>Worker nodes are responsible for executing tasks that are scheduled by the managers.
A worker node cannot change the desired state.
It can only take work and report back on the status.</p>

<p>The role of a node is dynamic.
We can increment or reduce the amount of managers by promoting or demoting nodes.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker node promote &lt;node-id&gt;
<span class="nv">$ </span>docker node demote &lt;node-id&gt;
</code></pre></div></div>

<h2 id="services">Services</h2>

<p>Docker 1.12 introduces a new <code class="language-plaintext highlighter-rouge">service</code> command.
A <strong>service</strong> is a set of tasks that can be easily replicated.
A <strong>task</strong> represents a workload and is executed by a container.
A task does not necessarily have to be a container,
but currently that is the only option.
In the future,
tasks can also be different types of workloads,
for example Unikernels.</p>

<p>The service command is very similar to the <code class="language-plaintext highlighter-rouge">run</code> command
and utilizes a lot of similar flags which we are used to work with.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--replicate</span> 3 <span class="nt">--name</span> frontend <span class="nt">--network</span> mynet <span class="nt">--publish</span> 80:80/tcp frontend_image:latest
</code></pre></div></div>

<p>The above command will create a service named <em>frontend</em>,
add it to the <em>mynet</em> network,
publish it to port 80,
and use the <em>frontend_image</em> for this service.</p>

<p>This does not only create the service,
but it defines the desired state.
The cluster constantly reconciles its state.
Upon a node failure,
the cluster will automatically self heal
and converge back to the desired state by scheduling new tasks on other nodes.</p>

<p>You can also define a <strong>Swarm mode</strong>.
For example,
if you wish to create a service that runs on <em>every node</em>,
you can easily do this using the <em>global</em> mode.
This will schedule all the tasks of a service on each node.
This is great for general services like monitoring.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--mode</span><span class="o">=</span>global <span class="nt">--name</span> prometheus prom/prometheus
</code></pre></div></div>

<p>Just like we can put constraints on containers,
we can put constraints on services:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker daemon <span class="nt">--label</span> com.example.storage<span class="o">=</span><span class="s2">"ssd"</span>
<span class="nv">$ </span>docker service ... <span class="nt">--constraint</span> com.example.storage<span class="o">=</span><span class="s2">"ssd"</span> ...
</code></pre></div></div>

<p>If we want more instances of our service,
we can scale our services up and down:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service scale <span class="nv">frontend</span><span class="o">=</span>10 <span class="nv">backend</span><span class="o">=</span>20
</code></pre></div></div>

<p>This will change the desired state of the service(s),
and the managers will schedule new tasks (or remove existing tasks) to attain this desired state.</p>

<p>We can also apply rolling updates to our services.
For example,
if we wish to upgrade our service to a newer version without any downtime,
we can use the <code class="language-plaintext highlighter-rouge">service update</code> command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker service update myservice --image myimage:2.0 --update-parallellism 2 --update-delay 10s
</code></pre></div></div>

<p>This will update our service by replacing 2 tasks at the time,
every 10 seconds.
We can also use this command to change environment variables,
ports,
etc.</p>

<p>As you can see,
the new <code class="language-plaintext highlighter-rouge">service</code> subcommand is very powerful and easy to use.</p>

<h2 id="bundles">Bundles</h2>

<p>A Distributed Application Bundle (DAB) file declares a stack of services,
including the versioning and how the networking is setup.
It is a deployment artifact that can be used in your continuous integration tools,
all the way from your laptop to production.</p>

<p>Currently,
one way to generate a <em>.dab</em> file is by creating the bundle using Docker Compose:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-compose bundle
</code></pre></div></div>

<p>This command will generate a <em>.dab</em> or <em>.dsb</em> file,
which is just a JSON text file.
Here’s a partial example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "services": {
    "db": {
      "Env": [
        "constraint:type==backend",
        "constraint:storage==ssd"
      ],
      "Image": "postgres@sha256:f76245b04ddbcebab5bb6c28e76947f49222c99fec4aadb0bb1c24821a9e83ef",
      "Networks": [
        "back-tier"
      ]
    }
  }
}
</code></pre></div></div>

<p>This feature is still experimental in Docker 1.12
and the specification is still being updated.
Docker invites everyone to provide feedback and hopes it will become the de facto standard for deploying applications.</p>

<h2 id="routing-mesh-networks">Routing Mesh Networks</h2>

<p>A problem with load balancers is the fact they are not container-aware,
but host-aware.
Load balancing containers has been hard up until now,
because you have to update the configuration of the load balancers as containers are started or stopped.
This is done by overriding the configuration file of the load balancer and restarting it,
or by updating the configuration in a distributed key-value store like etcd.</p>

<p>Docker now has built in load balancing in the Engine using a container-aware routing mesh.
This mesh network can transparantly reroute traffic from any host to a container.
For example,
publishing a service on port 80 will reserve a Swarm wide ingress port,
so that each node will listen to port 80.
Each node will then reroute traffic to the container using DNS based service discovery.</p>

<p>This is compatible with existing infrastructure.
External load balancer no longer need to know where the containers are running.
They can just point towards any node and the routing mesh will automatically redirect traffic.
Even though this introduces an extra hop,
it is still very efficient since it uses IPVS.</p>

<h2 id="security-out-of-the-box">Security Out Of The Box</h2>

<p>Docker now comes with out-of-the-box, zero-configuration security.
Docker sets up automatic certificate rotation,
TLS mutual authentication
and TLS encryption between nodes.</p>

<p><img class="image fit" src="/img/dockercon/swarm-tls.png" alt="Security" /></p>

<p><strong>There is no way to turn off security.</strong>
One of the core principles of Docker is simplicity.
Therefor,
security must be so simple to use,
that you don’t want to turn it off!</p>

<h2 id="container-health-check-in-dockerfile">Container Health Check in Dockerfile</h2>

<p>A new <code class="language-plaintext highlighter-rouge">HEALTHCHECK</code> keyword is available for Dockerfiles.
This keyword can be used to define the health check of a container.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HEALTHCHECK --interval=5m --timeout=3s --retries 3 CMD curl -f http://localhost || exit 1
</code></pre></div></div>

<p>In the above example,
health checking is done every 5 minutes.
A container becomes unhealthy if the <code class="language-plaintext highlighter-rouge">curl</code> command fails 3 times in a row with a 3 second timeout.</p>

<h2 id="new-plugin-subcommands-experimental">New Plugin Subcommands (experimental)</h2>

<p>A new <code class="language-plaintext highlighter-rouge">plugin</code> subcommand has been added which allows you to easily manager Docker plugins.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker plugin <span class="nb">install</span> &lt;plugin-name&gt;
<span class="nv">$ </span>docker plugin <span class="nb">enable</span> &lt;plugin-name&gt;
<span class="nv">$ </span>docker plugin disable &lt;plugin-name&gt;
</code></pre></div></div>

<p>Plugins also have a manifest file which describes the resources it needs.
You can compare it to how a new app on your smart phone asks for access to different resources,
like your photos or contacts.</p>

<h2 id="try-it-out">Try It Out!</h2>

<p>As of today,
the Docker for Mac/Windows beta,
which is already at Docker 1.12,
is open for everyone!
You can download it at <a href="http://docker.com/getdocker">docker.com/getdocker</a>.</p>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/conference/2016/06/20/whats-new-in-docker-112.html&title=DockerCon 2016 - What is new in Docker 1.12&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=DockerCon 2016 - What is new in Docker 1.12&url=https://ordina-jworks.github.io/conference/2016/06/20/whats-new-in-docker-112.html&via=lifeatordinabe&related=lifeatordinabe" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/conference/2016/06/20/whats-new-in-docker-112.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/tom-verelst/" class="image spotlight-image" title="">
            <img src="/img/author/tom-verelst.png"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Tom is a senior software engineer at Ordina Belgium. He is fond of all things Go and DevOps.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://twitter.com/lifeatordinabe" target="_blank">
                <i class="fa fa-fw fa-twitter"></i><span>Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2022 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/dockercon/dockercon.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
