<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Vuzix And How To Use It - Otte Fieremans and Fe Dekeyser">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/2023-08-25-vuzix-and-how-to-use-it/glasses.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/internship/2023/08/25/vuzix-and-how-to-use-it.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Vuzix And How To Use It - Otte Fieremans and Fe Dekeyser"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/2023-08-25-vuzix-and-how-to-use-it/glasses.png"/>

    
    <title>Vuzix And How To Use It - Otte Fieremans and Fe Dekeyser &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="https://join.ordina-jworks.io/">JOIN</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>Vuzix And How To Use It</h2>
                

                
                    Posted Aug 25, 2023


    in <a href="/categories/internship/">Internship</a>



    by
    
        <a href="/author/otte_fieremans/">Otte Fieremans</a>
        
            
                 and 
        
        
    
        <a href="/author/fe_dekeyser/">Fe Dekeyser</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/vuzix-blade/">Vuzix Blade</a>, 
    
        <a href="/tags/aws/">AWS</a>, 
    
        <a href="/tags/terraform/">Terraform</a>, 
    
        <a href="/tags/android/">Android</a>, 
    
        <a href="/tags/spring/">Spring</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <h1 id="table-of-contents">TABLE OF CONTENTS</h1>

<ul>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#what-needed-to-be-done">What needed to be done</a></li>
  <li><a href="#about-those-glasses">About those glasses</a></li>
  <li><a href="#android-app">Android App</a>
    <ul>
      <li><a href="#enhancing-the-user-experience">Enhancing user experience</a></li>
      <li><a href="#hands-free-experience">Hands-free experience</a></li>
      <li><a href="#user-inputs">User inputs</a></li>
      <li><a href="#optimization-and-testing">Optimization and testing</a></li>
    </ul>
  </li>
  <li><a href="#spring-boot-api">Spring Boot API</a>
    <ul>
      <li><a href="#rest">REST</a></li>
      <li><a href="#postgres-database">Postgres database</a></li>
      <li><a href="#api-integration">API integration</a></li>
    </ul>
  </li>
  <li><a href="#infrastructure-as-code">Infrastructure as code</a>
    <ul>
      <li><a href="#setting-up-the-s3-backend-the-tip-of-the-iceberg">Setting up the S3 backend, the tip of the iceberg</a></li>
      <li><a href="#setting-up-the-repository">Setting up the repository</a></li>
      <li><a href="#pushing-to-the-repository">Pushing to the repository</a>
        <ul>
          <li><a href="#the-trigger">The trigger</a></li>
          <li><a href="#jobs">Jobs</a></li>
          <li><a href="#ci">CI</a></li>
          <li><a href="#cd">CD</a></li>
        </ul>
      </li>
      <li><a href="#now-for-the-database">Now for the database</a></li>
      <li><a href="#lets-finally-run-the-api">Let’s finally run the API</a></li>
      <li><a href="#terraform-workflow">Terraform workflow</a></li>
      <li><a href="#visual-representation">Visual Representation</a></li>
    </ul>
  </li>
  <li><a href="#summary">Summary</a></li>
</ul>

<h1 id="introduction">INTRODUCTION</h1>

<p>In today’s world, there are numerous navigation options available, with every mobile phone equipped with GPS functionality.
However, what if there was an even easier way?
Our project offers a solution where you can embark on a seamless walk, bike ride, or any other journey without the need to constantly retrieve your phone from your pocket.
By following our app, you can effortlessly navigate your chosen route while remaining informed of crucial information such as direction, speed, distance, and potentially more.
The beauty lies in our app’s ability to project all this data onto your eyewear, enhancing your overall experience.</p>

<p>Simply upload your routes using GPX files, select the desired route, and you’re ready to begin your adventure!</p>

<h1 id="what-needed-to-be-done">WHAT NEEDED TO BE DONE</h1>

<p>The project we were about to embark on described building an Android application that runs on the Vuzix Blade AR glasses and communicates with an API that runs in a Cloud environment.</p>

<ul>
  <li>Build the Android application for the Vuzix Blade</li>
  <li>Set up an API with Spring Boot to read and write data to a database</li>
  <li>Connecting the Android application and API locally</li>
  <li>Expand the Android application with extra features</li>
  <li>Setting up the AWS infrastructure using Terraform</li>
  <li>Setting up a CI/CD pipeline to build the image and deploy it on AWS</li>
  <li>Expand the pipeline to apply Terraform on AWS</li>
  <li>Go for a walk</li>
</ul>

<h1 id="about-those-glasses">ABOUT THOSE GLASSES</h1>

<p>In today’s market, there is a considerable variety of “smart glasses” available.
However, when compared to other smart eyewear options, the Vuzix Blade stands out due to its subtle design, making it particularly well-suited for outdoor use.
Consequently, our app is specifically tailored to function seamlessly with this particular eyewear.
The only drawback worth mentioning is its limited battery life, which lasts for approximately one hour.
As a result, extended excursions would require the use of a power bank to ensure uninterrupted functionality.</p>

<p>If you desire to use these glasses for yourself here are some introductory steps to get you started on utilizing the full potential of the Vuzix Blade.</p>

<p><a href="https://files.vuzix.com/Content/pdfs/Vuzix-Blade-User-Manual.pdf" target="_blank" rel="noopener noreferrer">User Manual</a></p>

<h1 id="android-app">ANDROID APP</h1>

<p>The Vuzix Blade uses the Android 5 OS, so we developed our app using Android, utilizing the Java programming language.
While both of us were new to Android development, we already had experience working with mobile applications and Java, which allowed us to quickly grasp the necessary concepts and tools.
There were some difficulties since we were limited to features from Android API 22, but we still managed to bring the application to a desirable outcome.</p>

<h3 id="enhancing-the-user-experience">Enhancing the user experience</h3>

<p>Throughout the development process, we explored various features and functionalities that could enhance the user experience.
For instance, we implemented real-time GPS tracking to accurately monitor the user’s location and provide precise navigational instructions.
This way we could also show the user what speed they were travelling.
We use the magnetic field sensor in the glasses to determine the user’s direction and make sure they are always being directed in the right direction.</p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/Vuzix-App-main.png" style="margin:0px auto; max-width: 30%;" />
<img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/Vuzix-App-routes.png" style="margin:0px auto; max-width: 30%;" />
<img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/Vuzix-app-stats.png" style="margin:0px auto; max-width: 30%;" /></p>

<h3 id="hands-free-experience">Hands-free experience</h3>

<p>By utilising the Vuzix Blade’s display, we successfully projected relevant data, such as distance, speed and direction directly onto the user’s field of view, ensuring an intuitive and hands-free experience.
With a simplistic interface the user can easily select the route he wants to traverse and since it is displayed on smart glasses the black background makes it transparent, so the user has optimal visibility while traversing his path.
Furthermore, after having selected a route, the user will see information about the previous times he travelled the route as you can see on the image on the right.</p>

<h3 id="user-inputs">User inputs</h3>

<p>A user also has multiple inputs he can use to enhance the user experience.
They can go forward or back a point since most GPX file coordinates are rounded which can make the points that are marked sometimes appear inside of buildings.
Even when they are user-generated routes, and the user never came within a 10-meter radius of the building.
To further help with this but also for people who don’t want to begin at the start of their route or people who just got lost.
There is a rebase function that just puts you on the point closest to where you are regardless of where in your route you were.
The user can also at any point reload his statistics for the route he is travelling or start a new route.</p>

<h3 id="optimization-and-testing">Optimization and testing</h3>

<ul>
  <li>To ensure optimal performance, we employed efficient coding practices and utilized compatible libraries and frameworks for the Android platform.</li>
  <li>Rigorous testing was conducted to identify and address any potential issues or bugs, enhancing the overall app experience.</li>
</ul>

<p>By incorporating these enhancements, we have created an Android app that provides users with a seamless and intuitive navigation experience on the Vuzix Blade, leveraging real-time GPS tracking, user-friendly inputs, and optimized performance.</p>

<h1 id="spring-boot-api">SPRING BOOT API</h1>

<p>Our application leverages the power of a Spring Boot API integrated with a Postgres database.
This robust combination enables us to effortlessly retrieve routes from the cloud, providing users with easy access to their desired routes anytime, anywhere.</p>

<h3 id="rest">REST</h3>

<p>By utilizing Spring Boot as a middleware, our API serves as a bridge between our application and the Postgres database.
Spring Boot’s extensive set of modules and libraries provide a cohesive framework for building RESTful services, ensuring smooth and reliable communication between the application and the database.</p>

<h3 id="postgres-database">Postgres Database</h3>

<p>The Postgres database acts as a centralized repository, storing and managing all the route data and statistics.
With this centralized approach, we ensure data integrity and efficient querying capabilities, allowing users to access and analyze their route information effectively.
We save our GPX files as a String in a SQL Database with a Unique name, So the user won’t confuse their files and the API can query by name.
Route statistics are saved in the database, establishing a many-to-one relation with the GPX model.
These statistics capture essential information such as start and end times, enabling our application to calculate the duration of routes and average speeds accurately.</p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/Swagger.png" style="margin:0px auto; max-width: 100%;" /></p>

<p><em>The GPX object</em></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"gpx"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p><em>The RouteStatistic object</em></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"startDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endDate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"gpx"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="api-integration">API integration</h3>

<p>Experience hassle-free route management with our integrated API and Postgres database solution.
Seamlessly retrieve and manage routes with ease, enhancing your navigation experience.
Our user-friendly approach prioritizes data integrity, delivering a streamlined and intuitive route management solution.</p>

<h1 id="infrastructure-as-code">INFRASTRUCTURE AS CODE</h1>

<p>As the API took shape it was time to start thinking about how our infrastructure in the cloud would look like.
To manage and provision our infrastructure we used a little nifty tool called Terraform.</p>

<p>Terraform is an open-source infrastructure as code (IaC) tool developed by HashiCorp.
It enables the automation of provisioning and managing infrastructure resources across various cloud providers and on-premises environments.
With Terraform, you define your desired infrastructure configuration using a declarative language called HashiCorp Configuration Language (HCL).
These configurations, known as Terraform code, describe the desired state of your infrastructure, specifying the resources, dependencies, and configurations needed.
By executing Terraform commands, it compares the current state of the infrastructure with the desired state and determines the necessary actions to bring the infrastructure into the desired state.
Terraform’s ability to manage infrastructure as code allows for version control, collaboration, and reproducibility, making it an efficient and scalable solution for infrastructure management.</p>

<h3 id="setting-up-the-s3-backend-the-tip-of-the-iceberg">Setting up the S3 backend, the tip of the iceberg</h3>

<p>To begin our quest for provisioned infrastructure we needed a place to store the state of our configuration.
In Terraform x AWS an S3 bucket is used for exactly this.
Another necessary resource for setting up the S3 backend is a DynamoDB table.
This single table stores the lock of the state so that it cannot be accessed by multiple persons at a time, which could otherwise lead to configuration drift.</p>
<pre><code class="language-HCL">backend "s3" {
    bucket = "vuzix-blade-intership-tfstate"
    key    = "terraform/terraform.tfstate"
    region = "eu-west-1"
    profile = "vuzix-blade-internship"
    dynamodb_table = "vuzix-blade-internship-state-lock"
}
</code></pre>
<p><code class="language-plaintext highlighter-rouge">backend "s3" {}</code> provides the bucket to store the state, this block resides inside the main <code class="language-plaintext highlighter-rouge">terraform {}</code> block inside the <code class="language-plaintext highlighter-rouge">main.tf</code> file.
U can also see the <code class="language-plaintext highlighter-rouge">dynamodb_table</code> parameter which references the table for the state lock.</p>

<h3 id="setting-up-the-repository">Setting up the repository</h3>

<p>To start deploying our API to the cloud we’re going to need a place to store our built images, which the runner is going to use to launch the API.
Remember that we don’t even have a database and runner in the cloud yet.
The repository also has a lifecycle policy, this implies that the repository should only keep the 5 latest images, to keep it from overcrowding.</p>
<pre><code class="language-HCL">resource "aws_ecr_repository" "vuzix-blade-internship-container-repository" {
    name = "vuzix-blade-internship-container-repository"
    image_scanning_configuration {
        scan_on_push = true
    }
    tags = var.resource_tags
}
</code></pre>

<h3 id="pushing-to-the-repository">Pushing to the repository</h3>
<p>To push an image to the repository we could manually push it with a couple of docker commands, but it seemed more efficient to use GitHub Actions for this.
We can make a workflow file in our project which is going to run whenever we merge into the main branch from a pull request.
For now, we’ll take a break from Terraform to focus on the workflow which is written in YAML.</p>

<h4 id="the-trigger">The trigger</h4>

<p>This is the first and probably most important part of the workflow: defining a trigger.
In our application, the trigger is pulling into the main branch.</p>
<pre><code class="language-YAML">name: build/push workflow vuzix-blade-internship

on:
    push:
        branches:
            - main
</code></pre>
<h4 id="jobs">Jobs</h4>

<p>When the trigger is set, we’re ready to start defining jobs.
In our case we have 2 jobs, the deployment has been split into CI and CD respectively.</p>

<h4 id="ci">CI</h4>
<p>Inside this CI job, we are going to run our integration tests of the API to make sure that all the logic works to our liking before we build and push the image to the repository.</p>

<pre><code class="language-YAML">  ci:
    name: CI
    runs-on: [self-hosted, Linux]
    steps:
      - uses: actions/checkout@v2
      - name: Set up Java
        uses: actions/setup-java@v2
        with:
          distribution: "zulu"
          java-version: "17"
      - name: "Run tests"
        run: |
          chmod +x mvnw
          ./mvnw test
</code></pre>
<h4 id="cd">CD</h4>
<p>The CD job will only start when the CI job was successful.
Inside the CD job, we need to set up a couple of preparations before we can build and push to the repository.
We need permission to push to AWS, to get this permission we made a custom IAM role (this role was manually created) that we can assume in the runner.</p>

<pre><code class="language-YAML">- name: Configure AWS credentials
  uses: aws-actions/configure-aws-credentials@v2
  with:
    role-to-assume: $
    aws-region: eu-west-1

- name: Login To Amazon ECR
  id: login-ecr
  uses: aws-actions/amazon-ecr-login@v1
</code></pre>
<p><code class="language-plaintext highlighter-rouge">role-to-assume</code> lets us specify a role to assume with its ARN, this role must have the necessary permissions to perform all the actions inside the workflow.
Once the login attempt is successfully authenticated, the associated role will be assumed, granting the necessary permissions for ECR (Elastic Container Registry).</p>

<pre><code class="language-YAML">- name: Build Docker image
  env:
    ECR_REGISTRY: $
  run: |
    chmod +x mvnw
    ./mvnw spring-boot:build-image -Dspring-boot.build-image.imageName=$ECR_REGISTRY/$ECR_REPO_NAME:latest -DskipTests

- name: Push docker image
  env:
    ECR_REGISTRY: $
  run: |
    docker push $ECR_REGISTRY/$ECR_REPO_NAME:latest
</code></pre>
<p>We utilize a built-in Spring Boot plugin called Paketo. 
The command spring-boot:build-image mentioned above follows the prescribed naming convention for tagging the image before pushing it to an AWS repository.
The <code class="language-plaintext highlighter-rouge">docker push</code> command automatically recognizes that it needs to push to the specified repository, hence the naming convention.</p>

<p>If done correctly we can see that the repository in AWS receives and stores our image.</p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/ECR-screenshot.png" style="margin:0px auto; max-width: 100%;" /></p>

<h3 id="now-for-the-database">Now for the database</h3>

<p>The database consists of an RDS resource in AWS which is running a Postgres 15 engine.
Before we can begin setting up our RDS instance we have to decide how we’re going to handle the network situation.
We want to put our RDS in a VPC (Virtual Private Cloud) to keep it secure inside our public Cloud, we can specify this using an <code class="language-plaintext highlighter-rouge">aws_db_subnet_group</code>.
To ensure an optimal setup for the RDS (Relational Database Service), we require a couple of additional resources: an aws_db_parameter_group and an aws_security_group.
These resources play a crucial role in configuring and securing the RDS environment.</p>

<p>In the <code class="language-plaintext highlighter-rouge">aws_db_subnet_group</code> we just need to define our subnets and AWS will automatically recognize the correct VPC.</p>

<p>The <code class="language-plaintext highlighter-rouge">aws_db_parameter_group</code> is a default parameter group for RDS with the corresponding engine (Postgres 15).</p>

<p>Our <code class="language-plaintext highlighter-rouge">aws_security_group</code> which is specifically for our RDS will open the necessary ports in the VPC for inbound and outbound traffic from and to our App Runner (more on the App Runner later).</p>

<pre><code class="language-HCL">resource "aws_db_instance" "dev-vuzix-blade-internship-db" {
    allocated_storage = 10
    instance_class = "db.t3.micro"
    db_name = "blade"
    identifier = "dev-vuzix-blade-internship-db"
    engine = "postgres"
    engine_version = "15.2"
    username = var.db_username
    password = var.db_password
    
    parameter_group_name = "dev-vuzix-blade-internship-db"
    vpc_security_group_ids = [aws_security_group.vuzix-blade-internship-security-group.id]
    db_subnet_group_name = aws_db_subnet_group.vuzix-blade-internship-db-subnet-group.name

    skip_final_snapshot = true
    tags = var.resource_tags
    depends_on = [aws_db_parameter_group.dev-vuzix-blade-internship-db, aws_db_subnet_group.vuzix-blade-internship-db-subnet-group]
}
</code></pre>
<p>U can see in our <code class="language-plaintext highlighter-rouge">aws_db_instance</code> where we have defined the security group, VPC and parameter group in the parameters <code class="language-plaintext highlighter-rouge">vpc_security_group_ids</code>, <code class="language-plaintext highlighter-rouge">db_subnet_group_name</code> and <code class="language-plaintext highlighter-rouge">parameter_group_name</code>.</p>

<h3 id="lets-finally-run-the-api">Let’s finally run the API</h3>

<p>Now for the fun part: finally running our API in the cloud.
To achieve this, we’re using the App Runner resource.
There are a couple of things you need to take care of before trying to run your app in an App Runner.
The first requirement is for the resource to reside within the same Virtual Private Cloud (VPC) as the RDS, enabling connectivity between them.
The second requirement entails the need for a custom role assigned to the runner, granting permissions to fetch the image from the ECR (Elastic Container Registry).
Additionally, the runner must have a security group configured to establish a connection with the RDS (Relational Database Service).</p>

<p>In our <code class="language-plaintext highlighter-rouge">aws_security_group</code> that is specifically for our App Runner we specify the ports in the VPC for inbound and outbound traffic from and to the RDS.
The endpoint of our App Runner however is public, because of this the endpoint of the App Runner needs to be handled like a secret.</p>

<p>Similar to the <code class="language-plaintext highlighter-rouge">aws_db_subnet_group</code>, the <code class="language-plaintext highlighter-rouge">aws_apprunner_vpc_connector</code> which puts the App Runner in the desired VPC takes an Array of subnets as a parameter and automatically recognizes the VPC.</p>

<p>In the <code class="language-plaintext highlighter-rouge">aws_apprunner_service</code> you have to specify a role that has access to the image repository for pulling the image into the App Runner.
The role needs the permissions to be assumed by the App Runner and to perform actions on our image repository.
The specifying of a role is mandatory if the App Runner needs to access a private image repository.</p>

<pre><code class="language-HCL">resource "aws_apprunner_service" "vuzix-blade-internship-apprunner-service" {
    service_name = "vuzix-blade-internship-apprunner-service"
    tags = var.resource_tags
    network_configuration {
        egress_configuration {
            egress_type = "VPC"
            vpc_connector_arn = aws_apprunner_vpc_connector.vuzix-blade-internship-vpc-connector.arn
        }
    }
    source_configuration {
        authentication_configuration {
            access_role_arn = aws_iam_role.vuzix-blade-internship-apprunner-service-role.arn
        }
        image_repository {
            image_identifier      = "930970667460.dkr.ecr.eu-west-1.amazonaws.com/vuzix-blade-internship-container-repository:latest"
            image_repository_type = "ECR"
            image_configuration {
                port = 8080
                runtime_environment_variables = {
                    ENV = "prod"
                    DATABASE_ENDPOINT=aws_db_instance.dev-vuzix-blade-internship-db.endpoint
                    DATABASE_NAME=aws_db_instance.dev-vuzix-blade-internship-db.db_name
                    POSTGRES_USER=var.db_username
                    POSTGRES_PASSWORD=aws_secretsmanager_secret_version.vuziz-blade-internship-db-pwd-v1.secret_string
                }
            }
        }
    }
    depends_on = [aws_iam_role.vuzix-blade-internship-apprunner-service-role]
}
</code></pre>
<p>In the <code class="language-plaintext highlighter-rouge">aws_apprunner_service</code> above you can see the <code class="language-plaintext highlighter-rouge">network_configuration {}</code> block where the<code class="language-plaintext highlighter-rouge">aws_apprunner_vpc_connector</code> is specified and the <code class="language-plaintext highlighter-rouge">source_configuration {}</code> block where we specify the role for access to the ECR, what the image identifier is and how we want to configure the application.</p>

<h3 id="terraform-workflow">Terraform workflow</h3>

<p>After the App Runner was set up we wanted a way to automatically apply and destroy our Terraform configuration.
Because we do not want to lose any previously built images or data inside the database, the only resource being automatically destroyed and set up again is the App Runner.</p>

<pre><code class="language-YAML">name: Terraform Apply On Schedule

on:
  schedule:
    - cron: '0 6 * * 1-5'
</code></pre>
<p>The trigger for our Terraform Apply workflow.
This workflow runs every day from Monday to Friday at 6 am (UTC), and the Terraform Destroy workflow runs at 4 pm (UTC).</p>

<pre><code class="language-YAML">- name: Terraform Init
  run: |
    terraform init -input=false
    
- name: Terraform Apply
  env:
    DB_USERNAME: $
    DB_PASSWORD: $
  run: |
    terraform apply -var="db_username=$DB_USERNAME" -var="db_password=$DB_PASSWORD" --auto-approve
</code></pre>
<p>We initialize our Terraform and apply the configuration, the <code class="language-plaintext highlighter-rouge">terraform destroy</code> is very similar except for the fact that in the destroy we use the <code class="language-plaintext highlighter-rouge">-target</code> tag to target our App Runner resource.</p>

<h3 id="visual-representation">VISUAL REPRESENTATION</h3>

<p>Displayed below you will find two images, one representing the project as a whole and how it intertwines with our cloud infrastructure.
The second picture represents the entire Terraform state and the dependencies of each resource.</p>

<p><em>Project Visual</em></p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/infrastructure-graphical.png" style="margin:0px auto; max-width: 75%;" /></p>

<p><em>Terraform Graphical</em></p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/Terraform-graphical.png" style="margin:0px auto; max-width: 100%;" /></p>

<h1 id="summary">SUMMARY</h1>

<p>Our project encompasses various technologies and tools to enhance the navigation experience.
We leverage the Vuzix Blade smart glasses, utilizing their subtle design for outdoor use.
Our app, developed using Android and Java, seamlessly integrates with the Vuzix Blade, projecting useful information onto the user’s eyewear without hindering their sight.</p>

<p>Furthermore, our system incorporates a Spring Boot REST API integrated with a Postgres database.
This combination enables us to effortlessly send or retrieve routes and their analytics from the cloud, offering efficient data management and reliable access to essential navigation information.
To efficiently manage our cloud resources, we employ Terraform as our infrastructure-as-code tool.
With Terraform’s configuration files, we define and provision the required cloud resources, ensuring consistent and tailored infrastructure setups.
With a pipeline to automatically build and destroy cloud resources to have optimal availability and low costs.</p>

<p>Overall, our project integrates different technologies and tools, providing users with a convenient, hands-free navigation experience while optimizing resource management and leveraging cloud capabilities.</p>

<p>We also created this visual to represent all the technologies and tools we used to bring this project to fruition.</p>

<p><img class="image fit" src="/img/2023-08-25-vuzix-and-how-to-use-it/technologies.png" style="margin:0px auto; max-width: 100%;" /></p>

<p>Last but not least a special thanks to our mentors Jeroen Vereecken and Stijn Geerts for guiding us through our internship and helping us along the way.
And a big thanks to Nils Devos for giving us this opportunity.</p>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/internship/2023/08/25/vuzix-and-how-to-use-it.html&title=Vuzix And How To Use It&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=Vuzix And How To Use It&url=https://ordina-jworks.github.io/internship/2023/08/25/vuzix-and-how-to-use-it.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/internship/2023/08/25/vuzix-and-how-to-use-it.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/otte_fieremans/" class="image spotlight-image" title="">
            <img src="/img/author/otte-fieremans.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Otte is a graduating student Programming at Thomas More Campus De Nayer.</p>
</p>
            
        </div>
    </div>
    
    <div class="inner">
        <a href="/author/fe_dekeyser/" class="image spotlight-image" title="">
            <img src="/img/author/fe-dekeyser.png"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Fe is a graduating student Programming at Thomas More Campus De Nayer.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2023 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/2023-08-25-vuzix-and-how-to-use-it/glasses.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
