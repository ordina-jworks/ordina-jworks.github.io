<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Cypress: a new kid on the E2E block - Tim Vierbergen and Glenn Van De Putte">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/cypress/cypress-logo.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/testing/2019/07/18/Cypress.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Cypress: a new kid on the E2E block - Tim Vierbergen and Glenn Van De Putte"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/cypress/cypress-logo.png"/>

    
    <title>Cypress: a new kid on the E2E block - Tim Vierbergen and Glenn Van De Putte &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="https://join.ordina-jworks.io/">JOIN</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>Cypress: a new kid on the E2E block</h2>
                

                
                    Posted Jul 18, 2019


    in <a href="/categories/testing/">Testing</a>



    by
    
        <a href="/author/tim-vierbergen/">Tim Vierbergen</a>
        
            
                 and 
        
        
    
        <a href="/author/glenn-van-de-putte/">Glenn Van De Putte</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/continuous-integration/">Continuous Integration</a>, 
    
        <a href="/tags/e2e/">E2E</a>, 
    
        <a href="/tags/javascript/">JavaScript</a>, 
    
        <a href="/tags/testing/">Testing</a>, 
    
        <a href="/tags/selenium/">Selenium</a>, 
    
        <a href="/tags/cypress/">Cypress</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <h1 id="table-of-contents">Table of contents</h1>
<ol>
  <li><a href="#intro">Intro</a></li>
  <li><a href="#cypress">Cypress</a></li>
  <li><a href="#comparison">Comparison</a></li>
  <li><a href="#setting-up-cypress">Setting up Cypress</a></li>
  <li><a href="#amazing-features">Amazing features</a></li>
  <li><a href="#continuous-integration">Continuous Integration</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<h1 id="intro">Intro</h1>

<p>Those of us familiar with E2E testing a user interface, we all know the struggle.
Not only coding with waits and timeouts but setups that were harder to manage especially when running it on a continuous integration platform.
Maintaining versions, network issues, browser support, …</p>

<p>For as long as I can remember, there was one constant in this setup!
Selenium was always there.
No matter what framework you used, Nightwatch, Protractor, Gauge, Robot, …
Selenium was the man in the middle.
All I can remember from building a Selenium setup a few years ago, are all the difficulties and frustrations.
Communication was not working, versions were not matching, timeout issues due to network lag, ….
But still, Selenium was a dependency that was needed!</p>

<div style="text-align: center;">
  <img src="/img/cypress/selenium-setup.png" width="80%" />
</div>

<p>Not that I am not grateful for Selenium and its team of developers and maintainers, because let’s be honest, what would we have done without it?
But now, ohh yeah, there’s a new kid in town.</p>

<h1 id="cypress">Cypress</h1>

<blockquote>
  <p>Fast, easy and reliable testing for anything that runs in a browser
~<a target="\_blank" href="https://www.cypress.io/">Cypress</a></p>
</blockquote>

<p>Cypress is aiming to provide its users with a bundled experience for writing end-to-end tests for web applications.
While lots of other frameworks (as mentioned above) are all interacting over a Selenium server,
for remote communication and by definition, running its tests outside of the browser, Cypress is executed inside the browser.
Therefore Cypress is executed in the same runtime as your application itself.
Because of this, Cypress has native access to every single object. The <code class="language-plaintext highlighter-rouge">window</code>, the <code class="language-plaintext highlighter-rouge">document</code>, a <code class="language-plaintext highlighter-rouge">DOM</code>-element, a <code class="language-plaintext highlighter-rouge">service worker</code>, … .
Cypress does not need to send commands over-the-wire and can just access everything.</p>

<h1 id="comparison">Comparison</h1>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">Selenium</th>
      <th style="text-align: center">Cypress</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Debugging:</td>
      <td style="text-align: center">Hard/Remote</td>
      <td style="text-align: center">Easy/Access to everything/Nice tool</td>
    </tr>
    <tr>
      <td>Speed:</td>
      <td style="text-align: center">Remote = slow</td>
      <td style="text-align: center">In browser = Fast</td>
    </tr>
    <tr>
      <td>Parallel:</td>
      <td style="text-align: center">V</td>
      <td style="text-align: center">V</td>
    </tr>
    <tr>
      <td>Headless:</td>
      <td style="text-align: center">V</td>
      <td style="text-align: center">V</td>
    </tr>
    <tr>
      <td>Language support:</td>
      <td style="text-align: center">Java, Perl PHP, Python, Ruby, C#, Javascript</td>
      <td style="text-align: center">Javascript</td>
    </tr>
    <tr>
      <td>Browser support:</td>
      <td style="text-align: center">Everything</td>
      <td style="text-align: center">Only webkit</td>
    </tr>
  </tbody>
</table>

<h2 id="basic-architecture">Basic Architecture</h2>

<p>Cypress consists of a few different building blocks.
One of them is its own Nodejs process.
You can look at this as being a backend.
This backend then launches a browser window, sets up a proxy to this browser window and sets the domain to localhost.
The browser window has two iFrames inside.
One is for Cypress itself.
The second one will hold the application under test.
To make it possible to communicate with the application’s iFrame, it injects a <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code>-tag that also sets its domain to localhost.
Because now, both iFrames are running on ‘localhost’, it is possible to access everything of the application.</p>

<div style="text-align: center;">
  <img src="/img/cypress/cypress-setup.png" width="80%" />
</div>

<p>The proxy is proxying all requests from the web application itself to its backend.
Because the proxy is part of the Cypress-setup, Cypress can act as the man-in-the-middle and spy on, mock or modify the requests and responses.</p>

<p>Communication between the Cypress Nodejs-backend and the Cypress iFrame, that is running the tests, is through a websocket.</p>

<p>There are a few downsides as seen in the comparison.
Because Cypress is running inside of the browser, the language is Javascript.
Cypress only supports Chrome so far. Although Cypress is working on supporting other browsers.
Today there is no way of testing in Safari, Ìnternet Explorer, Edge, …
Cypress tests are written using Mocha and Chai.</p>

<h1 id="setting-up-cypress">Setting Up Cypress</h1>

<h2 id="installing-cypress">Installing Cypress</h2>

<p>Installation of Cypress is really simple.
You can install it through Yarn:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ yarn add cypress --dev
</code></pre></div></div>
<p>Or plain npm:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ npm install cypress --save-dev
</code></pre></div></div>

<p>You can also install it globally.
This way you do not need a local <code class="language-plaintext highlighter-rouge">package.json</code> to run Cypress and all Cypress commands can be run straight from the command line.</p>

<h2 id="running-cypress">Running Cypress</h2>

<p>Depending on how you just installed Cypress, you can run Cypress by:
<code class="language-plaintext highlighter-rouge">$ yarn run cypress open</code>
of
<code class="language-plaintext highlighter-rouge">$ $(npm bin)/cypress open</code></p>

<p>Or globally:
<code class="language-plaintext highlighter-rouge">$ cypress open</code></p>

<p>The first positive surprise!
When opening Cypress for the first time, it notices that you haven’t run it before and it kindly scaffolds a <code class="language-plaintext highlighter-rouge">/cypress</code> folder with examples into your project.
This way, you already have a configured <code class="language-plaintext highlighter-rouge">base</code> to start from.</p>

<div style="text-align: center;">
  <img src="/img/cypress/firsttime.png" width="80%" />
</div>

<div style="text-align: center;">
  <img src="/img/cypress/firsttime2.png" width="80%" />
</div>

<p>As you can see, Cypress opens its own application.
This is kind of a backend application that will orchestrate the tests.
Running one of the tests, means that Cypress will open a second window, which is actually just a new browser window.
It will then inject itself into that window in one frame, and load the application under test in another frame.</p>

<h2 id="configuring-cypress">Configuring Cypress</h2>

<p>You can custom configure Cypress by adding a <code class="language-plaintext highlighter-rouge">cypress.json</code> file in the root of your project.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">baseUrl</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://demo-app.localtest.me/demo-app</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">integrationFolder</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">src</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">testFiles</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">**.spec.js</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">reporter</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">mochawesome</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">reporterOptions</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">overwrite</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">html</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">json</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">reportDir</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">results</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">reportFilename</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">report.html</span><span class="dl">"</span>
 <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>You can always override these settings on the command-line:
<code class="language-plaintext highlighter-rouge">$ cypress run --spec src/** -c baseUrl=http://localhost</code></p>

<p>For a full overview of the configuration options, just check out the <a href="https://docs.cypress.io/guides/references/configuration.html#Options" target="blank">docs</a>.</p>

<h2 id="reporters">Reporters</h2>

<p>Just like other frameworks, Cypress lets you add custom reporters for the test results.
As you can see above, we’ve added <code class="language-plaintext highlighter-rouge">mochawesome</code>.</p>

<p>Install it via Yarn:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>yarn add mochawesome <span class="nt">--dev</span>
</code></pre></div></div>
<p>And then manually add it to the <code class="language-plaintext highlighter-rouge">cypress.json</code> config file.</p>

<p>Take a look at the <a href="https://www.npmjs.com/package/mochawesome" target="blank">documentation</a> for the configuration.</p>

<h2 id="cypress-and-typescript">Cypress and TypeScript</h2>

<blockquote>
  <p>Cypress ships with official type declarations for TypeScript. This allows you to write your tests in TypeScript. All that is required is a little bit of configuration. ~docs</p>
</blockquote>

<p>The documentation itself is linking to some different examples.
You can read all about the setup <a target="blank" href="https://docs.cypress.io/guides/tooling/typescript-support.html">here</a>.
And you can also take a look at the <code class="language-plaintext highlighter-rouge">npm package add-typescript-to-cypress</code> <a href="https://www.npmjs.com/package/@bahmutov/add-typescript-to-cypress" target="blank">here</a>.</p>

<h2 id="writing-your-first-tests">Writing your first tests</h2>

<p>As shown above, you can configure the path to your <code class="language-plaintext highlighter-rouge">spec</code>-files.
In our case, we are using <code class="language-plaintext highlighter-rouge">/src</code>.
Cypress will go through that directory and show all the spec files when using Cypress in development mode.
When running Cypress command line to only run the tests, it will just run all those <code class="language-plaintext highlighter-rouge">spec</code>-files and then create the report.</p>

<p>In our small example we have an Angular demo app that has a material <code class="language-plaintext highlighter-rouge">sidenav</code> with three links.
Dashboard, clients and products.
The latter two both have a material <code class="language-plaintext highlighter-rouge">datatable</code>.</p>

<div style="text-align: center;">
  <img src="/img/cypress/demo-app.png" width="80%" />
</div>

<p>Let’s say we want to test our clients navigation and <code class="language-plaintext highlighter-rouge">datatable</code>.
Create a <code class="language-plaintext highlighter-rouge">spec</code> file in the <code class="language-plaintext highlighter-rouge">/src</code> directory, in our case, named <code class="language-plaintext highlighter-rouge">clients.spec.js</code>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">/// &lt;reference types="Cypress" /&gt;</span>

<span class="nx">context</span><span class="p">(</span><span class="dl">'</span><span class="s1">Clients test</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="dl">'</span><span class="s1">/clients</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">})</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Clients page should have Clients as a title</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">.table-container-header h1</span><span class="dl">'</span><span class="p">).</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">Clients</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Clients table should initially have 20 rows</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">.mat-row</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">$rows</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nx">expect</span><span class="p">(</span><span class="nx">$rows</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">Clients table should show 10 rows when pagesize is set to 10</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">mat-select</span><span class="dl">'</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
        <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">mat-option</span><span class="dl">'</span><span class="p">).</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">10</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">option</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="nx">cy</span><span class="p">.</span><span class="nx">wrap</span><span class="p">(</span><span class="nx">option</span><span class="p">).</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">10</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">option</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">click</span><span class="p">();</span>
            <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">mat-select</span><span class="dl">'</span><span class="p">).</span><span class="nx">contains</span><span class="p">(</span><span class="dl">'</span><span class="s1">10</span><span class="dl">'</span><span class="p">);</span>
            <span class="nx">cy</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">.mat-row</span><span class="dl">'</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">$rows</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
                <span class="nx">expect</span><span class="p">(</span><span class="nx">$rows</span><span class="p">.</span><span class="nx">length</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">be</span><span class="p">.</span><span class="nx">eq</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
              <span class="p">});</span>
        <span class="p">});</span>

    <span class="p">});</span>
<span class="p">})</span>
</code></pre></div></div>

<h2 id="running-your-first-tests">Running your first tests</h2>

<p>If you would now run <code class="language-plaintext highlighter-rouge">$ yarn run cypress open</code>.
Cypress will open itself, showing you your new <code class="language-plaintext highlighter-rouge">spec</code>-file.
You can now run your <code class="language-plaintext highlighter-rouge">spec</code>-file by double clicking it, or click the ‘run all’ option on the top right of your Cypress application.</p>

<p>Changing the <code class="language-plaintext highlighter-rouge">spec</code>-file will trigger a reload/retest in your Cypress-environment.</p>

<div style="text-align: center;">
  <img src="/img/cypress/main-app.png" width="80%" />
</div>

<h1 id="amazing-features">Amazing features</h1>

<p>The purpose of this post is not to provide you with some sample code, but trying to convince you to take a look at Cypress.
To do so, I’ll quickly go over some really nice features because besides the easy setup and nice main application, Cypress has much more to offer.</p>

<h2 id="debugging-with-cypress">Debugging with Cypress</h2>

<p>One of the hardest things when writing E2E tests is debugging.
Running tests over and over again, while logging everything to check what is going on, is now history.
Cypress injects itself in the same window as the application under test, so it has access to everything.
Everything, including the debugger.</p>

<p>This means that you can actually debug your test code as you would debug the application itself.
Although using the debugger is not that straight forward, it’s a great help.
Check out out the documentation <a href="https://docs.cypress.io/guides/guides/debugging.html#Using-debugger" target="blank">here</a>.</p>

<h2 id="snapshots">Snapshots</h2>

<div style="text-align: center;">
  <img src="/img/cypress/snapshot.png" width="80%" />
</div>

<p>Take a look at the image above.
As you can see, Cypress takes a snapshot at every stage of the test.
You can navigate through them later and see the snapshot at a specific time and even see the difference in the state of the application before a request and after its response when running <code class="language-plaintext highlighter-rouge">XHR requests</code>.</p>

<h2 id="network-accessibility">Network accessibility</h2>

<p>As mentioned above, Cypress can take snapshots before and after each <code class="language-plaintext highlighter-rouge">XHR request</code>.
Cypress knows what is going on under the hood because it is running in the same window.
This makes it easy to implement stubs and spies.</p>

<p>A simple example for our use case would be intercepting the <code class="language-plaintext highlighter-rouge">client-service</code> calls and return mocked data.
To do so, Cypress needs to run a server.
This can be done by just running <code class="language-plaintext highlighter-rouge">cy.server()</code>.
Next step is to define the route you want to listen on and attach new data to it.
Cypress enables this with its <code class="language-plaintext highlighter-rouge">route</code> configuration.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">beforeEach</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">cy</span><span class="p">.</span><span class="nx">server</span><span class="p">();</span>
  <span class="nx">cy</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">**/*/api/client-service/**/*</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:[</span>
        <span class="p">{</span>
          <span class="dl">"</span><span class="s2">id</span><span class="dl">"</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">firstName</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Tatiana</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">lastName</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Velez</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">email</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">diam.dictum@Proin.net</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">birthday</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">626286135</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">city</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Dumfries</span><span class="dl">"</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">zip</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">694245</span><span class="dl">"</span>
        <span class="p">}</span>
      <span class="p">],</span>
      <span class="dl">"</span><span class="s2">pageable</span><span class="dl">"</span><span class="p">:{</span>
        <span class="dl">"</span><span class="s2">sort</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
          <span class="dl">"</span><span class="s2">sorted</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
          <span class="dl">"</span><span class="s2">unsorted</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span>
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">pageSize</span><span class="dl">"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">pageNumber</span><span class="dl">"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">offset</span><span class="dl">"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">paged</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">unpaged</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span>
      <span class="p">},</span>
      <span class="dl">"</span><span class="s2">last</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">totalElements</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">totalPages</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">first</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">sort</span><span class="dl">"</span><span class="p">:{</span>
         <span class="dl">"</span><span class="s2">sorted</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span>
         <span class="dl">"</span><span class="s2">unsorted</span><span class="dl">"</span><span class="p">:</span><span class="kc">false</span>
      <span class="p">},</span>
      <span class="dl">"</span><span class="s2">numberOfElements</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">size</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">number</span><span class="dl">"</span><span class="p">:</span><span class="mi">0</span>
    <span class="p">}</span>
  <span class="p">).</span><span class="k">as</span><span class="p">(</span><span class="dl">'</span><span class="s1">stub-clients</span><span class="dl">'</span><span class="p">);</span>   
  <span class="nx">cy</span><span class="p">.</span><span class="nx">visit</span><span class="p">(</span><span class="dl">'</span><span class="s1">/clients</span><span class="dl">'</span><span class="p">);</span>
<span class="p">})</span>
</code></pre></div></div>

<div style="text-align: center;">
  <img src="/img/cypress/network-stub.png" width="80%" />
</div>

<h2 id="screenshots-and-videos">Screenshots and videos</h2>

<p>Another cool embedded feature is the ability to capture screenshots or record videos.
Cypress comes with screenshot and video recording out of the box.
Screenshots always come in handy when trying to find a bug.
Cypress even lets you take a screenshot, manually, from within your code.
Before, we were always setting this up using ‘yet another plugin’ (and dependency).</p>

<h1 id="continuous-integration">Continuous integration</h1>

<p>Running Cypress on a continuous integration platform is also pretty easy.
You just want Cypress to run the tests and not to open its Electron test manager for development.
<code class="language-plaintext highlighter-rouge">$ cypress run</code> just does that.
Just append the other options you want to override from the <code class="language-plaintext highlighter-rouge">cypress.json</code> and you are good to go.
<code class="language-plaintext highlighter-rouge">$ yarn run cypress run --spec 'src/**/*' --reporter mochawesome --reporter-options reportDir=results,reportFilename=report.html</code>.</p>

<p>Example <code class="language-plaintext highlighter-rouge">package.json</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">scripts</span><span class="p">:</span> <span class="p">{</span>
  <span class="p">...</span>
  <span class="dl">"</span><span class="s2">cypress:ci</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">cypress run --spec 'src/**/*' --reporter mochawesome --reporter-options reportDir=results,reportFilename=report.html</span><span class="dl">"</span>
  <span class="p">...</span>
<span class="p">}</span>
</code></pre></div></div>

<div style="text-align: center;">
  <img src="/img/cypress/command-line.png" width="80%" />
</div>

<div style="text-align: center;">
  <img src="/img/cypress/mochawesome.png" width="80%" />
</div>

<h1 id="conclusion">Conclusion</h1>

<p>Although there are still some downsides to this new player in the E2E testing field, such as only supporting JavaScript and Chrome, there are just too many positives to keep it on the sideline.
Cypress provides us with a new amazing test runner and manager. It strips all the hassles of previous setups and provides us with a real robust framework.
It is providing us with cool but effective features like the snapshot time travel, easy debugging, headful/headless mode for CI and more.</p>

<p>Cypress is too good to not take a look at!</p>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/testing/2019/07/18/Cypress.html&title=Cypress: a new kid on the E2E block&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=Cypress: a new kid on the E2E block&url=https://ordina-jworks.github.io/testing/2019/07/18/Cypress.html&via=lifeatordinabe&related=lifeatordinabe" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/testing/2019/07/18/Cypress.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/tim-vierbergen/" class="image spotlight-image" title="">
            <img src="/img/author/tim-vierbergen.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Tim is a senior developer and architect at JWorks Ordina Belgium. Tim has a DevOps culture mindset and is experienced in many different domains. From frontend to backend to pipelining and automation. Tim is keen on learning new technologies.<br /><br />Tim is a true sportsman and spends part of his free time running and working out. Tim is also very passionate about surfing and is learning how to snowboard.</p>
</p>
            
        </div>
    </div>
    
    <div class="inner">
        <a href="/author/glenn-van-de-putte/" class="image spotlight-image" title="">
            <img src="/img/author/glenn-van-de-putte.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Glenn is a Java Consultant at Ordina Belgium. With a background in testing, his main interests lie in all things automation, from automated testing to CI/CD and cloud automation.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://twitter.com/lifeatordinabe" target="_blank">
                <i class="fa fa-fw fa-twitter"></i><span>Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2023 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/cypress/cypress-logo.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
