<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Lagom 1.4 and Kubernetes orchestration - Yannick De Turck">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/lagom-kubernetes.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/orchestration/2018/05/22/lagom-1-4-and-kubernetes-orchestration.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Lagom 1.4 and Kubernetes orchestration - Yannick De Turck"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/lagom-kubernetes.png"/>

    
    <title>Lagom 1.4 and Kubernetes orchestration - Yannick De Turck &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="https://join.ordina-jworks.io/">JOIN</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>Lagom 1.4 and Kubernetes orchestration</h2>
                

                
                    Posted May 22, 2018


    in <a href="/categories/orchestration/">Orchestration</a>



    by
    
        <a href="/author/yannick-de-turck/">Yannick De Turck</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/lagom/">Lagom</a>, 
    
        <a href="/tags/java/">Java</a>, 
    
        <a href="/tags/scala/">Scala</a>, 
    
        <a href="/tags/reactive/">Reactive</a>, 
    
        <a href="/tags/kubernetes/">Kubernetes</a>, 
    
        <a href="/tags/minikube/">Minikube</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <h2 id="table-of-contents">Table of Contents</h2>

<ol>
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#upgrading-to-lagom-14">Upgrading to Lagom 1.4</a></li>
  <li><a href="#lightbends-orchestration-tools">Lightbend’s orchestration tools</a></li>
  <li><a href="#adding-kubernetes-support-to-our-lagom-shop-scala-application">Adding Kubernetes support to our Lagom Shop Scala application</a></li>
  <li><a href="#building-and-publishing-docker-images">Building and publishing Docker images</a></li>
  <li><a href="#locally-deploying-to-kubernetes-using-minikube">Locally deploying to Kubernetes using Minikube</a></li>
  <li><a href="#generating-kubernetes-resources-for-production">Generating Kubernetes resources for production</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#extra-resources">Extra resources</a></li>
</ol>

<h2 id="introduction">Introduction</h2>
<p>In this blog post we will take a closer look at the <a href="https://developer.lightbend.com/docs/lightbend-orchestration-kubernetes/latest/index.html" target="_blank" rel="noopener noreferrer">Lightbend Orchestration tools</a>.
Tools helping you deploy your Lagom application to Kubernetes and DC/OS.
It was already possible to deploy Lagom applications to Kubernetes as <a href="https://developer.lightbend.com/guides/lagom-kubernetes-k8s-deploy-microservices/" target="_blank" rel="noopener noreferrer">this guide</a> demonstrates but it involved more manual tasks and having to write the Kubernetes resource and configuration files yourself, as it usually goes.</p>

<p>As it currently stands, the tools are only supported in combination with sbt so Maven users cannot fully take advantage of it just yet.
Maven support will follow soon however as the <a href="https://github.com/lightbend/reactive-app-maven-plugin" target="_blank" rel="noopener noreferrer">Maven equivalent plugin</a> is nearing its first release version.</p>

<p>If you are new to Lagom feel free to take a look at one of our earlier blog posts on Lagom:</p>
<ul>
  <li><a href="/microservices/2016/04/22/Lagom-First-Impressions-and-Initial-Comparison-to-Spring-Cloud.html" target="_blank" rel="noopener noreferrer">Lagom: First Impressions and Initial Comparison to Spring Cloud</a></li>
  <li><a href="/microservices/2017/02/01/Lagom-1-2.html" target="_blank" rel="noopener noreferrer">Lagom 1.2: What’s new?</a></li>
</ul>

<p>Before getting to that though, we will upgrade our sample application <a href="https://github.com/yannickdeturck/lagom-shop-scala" target="_blank" rel="noopener noreferrer">Lagom Shop Scala</a>, which was also referred to in our previous blog posts, 
from Lagom 1.2 to <a href="https://www.lagomframework.com/blog/lagom-1-4-0.html" target="_blank" rel="noopener noreferrer">Lagom 1.4</a> to demonstrate the upgrading process.
The application consists of two Lagom microservices combined with a frontend written in Play Framework.
Afterwards we will take a closer look at how easy it is to integrate the Lightbend Orchestration tools into our project and how we can get our project up and running on Kubernetes.
Note that this blog post is not an in-depth guide on the tools themselves but more a general overview and for us to share our impressions.</p>

<h2 id="upgrading-to-lagom-14">Upgrading to Lagom 1.4</h2>
<p>In this section we will upgrade our sample application <a href="https://github.com/yannickdeturck/lagom-shop-scala" target="_blank" rel="noopener noreferrer">Lagom Shop Scala</a>, from version 1.3.4 to 1.4.x.
Lagom 1.4 uses Play Framework’s latest version, 2.6 for which we will also need to change a few things in our project.</p>

<p>Lightbend provides a migration guide for each new version they release, so in this case we followed the <a href="https://www.lagomframework.com/documentation/1.4.x/scala/Migration14.html" target="_blank" rel="noopener noreferrer">Lagom 1.4 Migration Guide</a> and the <a href="https://www.playframework.com/documentation/2.6.x/Migration26" target="_blank" rel="noopener noreferrer">Play 2.6 Migration Guide</a>.
When upgrading multiple minor versions, it is advised to upgrade one minor version at a time to smoothen the process.
In our case we are only limited to upgrading a single minor version so we can just use the latest migration guide right away.</p>

<p>Upgrade the Lagom version in <code class="language-plaintext highlighter-rouge">project/plugins.sbt</code>:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">addSbtPlugin</span><span class="o">(</span><span class="s">"com.lightbend.lagom"</span> <span class="o">%</span> <span class="s">"lagom-sbt-plugin"</span> <span class="o">%</span> <span class="s">"1.4.5"</span><span class="o">)</span>
</code></pre></div></div>

<p>Upgrade the sbt version in <code class="language-plaintext highlighter-rouge">project/build.properties</code>:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">sbt</span><span class="o">.</span><span class="py">version</span><span class="k">=</span><span class="mf">0.13</span><span class="o">.</span><span class="mi">16</span>
</code></pre></div></div>

<p>Upgrade the Scala version to <code class="language-plaintext highlighter-rouge">2.12.4</code> in <code class="language-plaintext highlighter-rouge">build.sbt</code>:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scalaVersion</span> <span class="n">in</span> <span class="nc">ThisBuild</span> <span class="o">:=</span> <span class="s">"2.12.4"</span>
</code></pre></div></div>

<p>Upgrade Play JSON Derived Codecs to 4.0.0 which adds Play 2.6 support:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">playJsonDerivedCodecs</span> <span class="k">=</span> <span class="s">"org.julienrf"</span> <span class="o">%%</span> <span class="s">"play-json-derived-codecs"</span> <span class="o">%</span> <span class="s">"4.0.0"</span>
</code></pre></div></div>

<p>Replace <code class="language-plaintext highlighter-rouge">play.api.data.validation.ValidationError</code> with <code class="language-plaintext highlighter-rouge">play.api.libs.json.JsonValidationError</code>.</p>

<p>Mix in <code class="language-plaintext highlighter-rouge">LagomConfigComponent</code>, <code class="language-plaintext highlighter-rouge">HttpFiltersComponents</code> and <code class="language-plaintext highlighter-rouge">AssetsComponents</code> and remove <code class="language-plaintext highlighter-rouge">lazy val assets: Assets = wire[Assets]</code> in the application loader class extending <code class="language-plaintext highlighter-rouge">BuiltInComponentsFromContext</code> in the Play frontend project.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">abstract</span> <span class="k">class</span> <span class="nc">Frontend</span><span class="o">(</span><span class="n">context</span><span class="k">:</span> <span class="kt">Context</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">BuiltInComponentsFromContext</span><span class="o">(</span><span class="n">context</span><span class="o">)</span>
  <span class="k">with</span> <span class="n">I18nComponents</span>
  <span class="k">with</span> <span class="nc">AhcWSComponents</span>
  <span class="k">with</span> <span class="nc">LagomKafkaClientComponents</span>
  <span class="k">with</span> <span class="nc">LagomServiceClientComponents</span>
  <span class="k">with</span> <span class="nc">LagomConfigComponent</span>
  <span class="k">with</span> <span class="nc">HttpFiltersComponents</span>
  <span class="k">with</span> <span class="nc">AssetsComponents</span> <span class="o">{</span>
</code></pre></div></div>

<p>Change <code class="language-plaintext highlighter-rouge">override def describeServices</code> to <code class="language-plaintext highlighter-rouge">override def describeService</code> in each Lagom project’s class extending <code class="language-plaintext highlighter-rouge">LagomServerComponents</code> as the other one has become deprecated.</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="k">def</span> <span class="nf">describeService</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="n">readDescriptor</span><span class="o">[</span><span class="kt">ItemService</span><span class="o">])</span>
</code></pre></div></div>

<p>Implement CSRF security in the frontend project by utilising CSRF form fields (<code class="language-plaintext highlighter-rouge">@CSRF.formField</code>) or <a href="https://www.playframework.com/documentation/2.6.x/ScalaCsrf#Protecting-against-Cross-Site-Request-Forgery" target="_blank" rel="noopener noreferrer">one of the other approaches</a>.</p>

<p>Note that Lagom’s development mode service locator now listens on port 9008 instead of 8000 although this can still be changed by <a href="https://www.lagomframework.com/documentation/1.4.x/scala/ServiceLocator.html#Default-port" target="_blank" rel="noopener noreferrer">overriding the default port</a>.</p>

<p>To see a complete list of changes we did, refer to commit <a href="https://github.com/yannickdeturck/lagom-shop-scala/commit/bdf5ecff50df606c2f4ed15200ce76b9d14c8f0a" target="_blank" rel="noopener noreferrer">bdf5ecff</a>.</p>

<h2 id="lightbends-orchestration-tools">Lightbend’s orchestration tools</h2>
<p>As we mentioned in the introduction, Lightbend offers a developer-centric suite of tools helping you deploy your Play/Akka/Lagom applications to Kubernetes and DC/OS.
The tools help you create a Docker image of all your applications, 
help with generating Kubernetes and DC/OS resource and configuration files based on the Docker images, 
and they allow you to deploy your whole Lagom project to Kubernetes using a simple command which can be pretty convenient for development. 
The generated JSON and YAML files could be put under version control after which they can be submitted to a CI/CD integrated central repository.</p>

<p>The suite consists of three different tools:</p>
<ul>
  <li><a href="https://github.com/lightbend/sbt-reactive-app" target="_blank" rel="noopener noreferrer">sbt-reactive-app</a>, an sbt plugin that inspects your projects and builds annotated Docker images.
The <a href="https://github.com/lightbend/reactive-app-maven-plugin" target="_blank" rel="noopener noreferrer">Maven equivalent plugin</a> is still being worked on and is nearing its first release version.</li>
  <li><a href="https://github.com/lightbend/reactive-cli" target="_blank" rel="noopener noreferrer">reactive-cli</a>, a command-line tool with which you generate the Kubernetes and DC/OS resource and configuration files.
You need to install this on the device or environment from which you will deploy to Kubernetes.
Install guidelines are available in the <a href="https://developer.lightbend.com/docs/lightbend-orchestration-kubernetes/latest/cli-installation.html#install-the-cli" target="_blank" rel="noopener noreferrer">documentation</a>.
For Mac for example this is easily accomplished with Homebrew:
    <pre><code class="language-sbtshell">brew tap lightbend/tools &amp;&amp; brew install lightbend/tools/reactive-cli
</code></pre>
  </li>
  <li><a href="https://github.com/lightbend/reactive-lib/" target="_blank" rel="noopener noreferrer">reactive-lib</a>, a library for your application that is automatically included in your application’s build by the sbt-reactive-app sbt plugin.
It allows your application to perform service discovery, access secrets, define health and readiness checks, and more as it understands the conventions of the resources generated by the command-line tool.</li>
</ul>

<h2 id="adding-kubernetes-support-to-our-lagom-shop-scala-application">Adding Kubernetes support to our Lagom Shop Scala application</h2>
<p>We start off with adding the <code class="language-plaintext highlighter-rouge">sbt-reactive-app</code> sbt plugin in the <code class="language-plaintext highlighter-rouge">project/plugins.sbt</code> file:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">addSbtPlugin</span><span class="o">(</span><span class="s">"com.lightbend.rp"</span> <span class="o">%</span> <span class="s">"sbt-reactive-app"</span> <span class="o">%</span> <span class="s">"1.1.0"</span><span class="o">)</span>
</code></pre></div></div>

<p>Now enable the plugin for each module in the <code class="language-plaintext highlighter-rouge">build.sbt</code> file:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">lazy</span> <span class="k">val</span> <span class="nv">itemImpl</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="nf">file</span><span class="o">(</span><span class="s">"item-impl"</span><span class="o">))</span>
  <span class="o">.</span><span class="py">dependsOn</span><span class="o">(</span><span class="n">itemApi</span><span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span><span class="n">commonSettings</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
  <span class="o">.</span><span class="py">enablePlugins</span><span class="o">(</span><span class="nc">LagomScala</span><span class="o">,</span> <span class="nc">SbtReactiveAppPlugin</span><span class="o">)</span>
  
<span class="k">lazy</span> <span class="k">val</span> <span class="nv">orderImpl</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="nf">file</span><span class="o">(</span><span class="s">"order-impl"</span><span class="o">))</span>
  <span class="o">.</span><span class="py">dependsOn</span><span class="o">(</span><span class="n">orderApi</span><span class="o">,</span> <span class="n">itemApi</span><span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span><span class="n">commonSettings</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
  <span class="o">.</span><span class="py">enablePlugins</span><span class="o">(</span><span class="nc">LagomScala</span><span class="o">,</span> <span class="nc">SbtReactiveAppPlugin</span><span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span>
    <span class="n">libraryDependencies</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="n">lagomScaladslPersistenceCassandra</span><span class="o">,</span>
      <span class="n">lagomScaladslTestKit</span><span class="o">,</span>
      <span class="n">lagomScaladslKafkaBroker</span><span class="o">,</span>
      <span class="n">cassandraDriverExtras</span><span class="o">,</span>
      <span class="n">macwire</span><span class="o">,</span>
      <span class="n">scalaTest</span>
    <span class="o">)</span>
  <span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span><span class="n">lagomForkedTestSettings</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
  
<span class="k">lazy</span> <span class="k">val</span> <span class="nv">frontend</span> <span class="k">=</span> <span class="o">(</span><span class="n">project</span> <span class="n">in</span> <span class="nf">file</span><span class="o">(</span><span class="s">"frontend"</span><span class="o">))</span>
  <span class="o">.</span><span class="py">dependsOn</span><span class="o">(</span><span class="n">itemApi</span><span class="o">,</span> <span class="n">orderApi</span><span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span><span class="n">commonSettings</span><span class="k">:</span> <span class="k">_</span><span class="kt">*</span><span class="o">)</span>
  <span class="o">.</span><span class="py">enablePlugins</span><span class="o">(</span><span class="nc">PlayScala</span> <span class="o">&amp;&amp;</span> <span class="nc">LagomPlay</span><span class="o">,</span> <span class="nc">SbtReactiveAppPlugin</span><span class="o">)</span>
  <span class="o">.</span><span class="py">settings</span><span class="o">(</span>
    <span class="n">version</span> <span class="o">:=</span> <span class="s">"1.0-SNAPSHOT"</span><span class="o">,</span>
    <span class="n">libraryDependencies</span> <span class="o">++=</span> <span class="nc">Seq</span><span class="o">(</span>
      <span class="n">lagomScaladslServer</span><span class="o">,</span>
      <span class="n">lagomScaladslKafkaClient</span><span class="o">,</span>
      <span class="n">macwire</span><span class="o">,</span>
      <span class="n">scalaTest</span><span class="o">,</span>
      <span class="s">"org.webjars"</span> <span class="o">%</span> <span class="s">"foundation"</span> <span class="o">%</span> <span class="s">"6.2.3"</span><span class="o">,</span>
      <span class="s">"org.webjars"</span> <span class="o">%</span> <span class="s">"foundation-icon-fonts"</span> <span class="o">%</span> <span class="s">"d596a3cfb3"</span>
    <span class="o">),</span>
    <span class="nv">EclipseKeys</span><span class="o">.</span><span class="py">preTasks</span> <span class="o">:=</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">compile</span> <span class="n">in</span> <span class="nc">Compile</span><span class="o">),</span>
    <span class="n">httpIngressPaths</span> <span class="o">:=</span> <span class="nc">Seq</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
  <span class="o">)</span>
</code></pre></div></div>

<p>If you also have a frontend module it is important to define the <code class="language-plaintext highlighter-rouge">httpIngressPaths</code>, as you might have seen in the code sample above, in order to have your frontend be accessible from outside the cluster.</p>

<p>Mix in the <code class="language-plaintext highlighter-rouge">LagomServiceLocatorComponents</code> trait in each module’s application loader:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.lightbend.rp.servicediscovery.lagom.scaladsl.LagomServiceLocatorComponents</span>

<span class="k">class</span> <span class="nc">ItemApplicationLoader</span> <span class="k">extends</span> <span class="nc">LagomApplicationLoader</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">load</span><span class="o">(</span><span class="n">context</span><span class="k">:</span> <span class="kt">LagomApplicationContext</span><span class="o">)</span><span class="k">:</span> <span class="kt">LagomApplication</span> <span class="o">=</span>
    <span class="k">new</span> <span class="nc">ItemApplication</span><span class="o">(</span><span class="n">context</span><span class="o">)</span> <span class="k">with</span> <span class="nc">LagomServiceLocatorComponents</span> <span class="o">{</span>
      <span class="k">override</span> <span class="k">lazy</span> <span class="k">val</span> <span class="nv">circuitBreakerMetricsProvider</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">CircuitBreakerMetricsProviderImpl</span><span class="o">(</span><span class="n">actorSystem</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="building-and-publishing-docker-images">Building and publishing Docker images</h2>
<p>The tool suite comes with an easy way to deploy all your services to Minikube for development so you will want to set that up first.
For installation instructions, consult the <a href="https://kubernetes.io/docs/getting-started-guides/minikube/" target="_blank" rel="noopener noreferrer">Minikube documentation</a>.</p>

<p>Start up Minikube with a sufficient amount of memory:</p>
<pre><code class="language-sbtshell">$ minikube start --memory 8192
Starting local Kubernetes v1.10.0 cluster...
Starting VM...
Getting VM IP address...
Moving files into cluster...
Setting up certs...
Connecting to cluster...
Setting up kubeconfig...
Starting cluster components...
Kubectl is now configured to use the cluster.
Loading cached images from config file.
</code></pre>

<p>You kind of need a decent device with a decent amount of RAM.
I have tested all of this on a MacBook Pro with 8GB RAM and I simply was not able to assign a sufficient amount of memory to comfortably run everything locally.</p>

<p>Execute the following command to have our Docker environment variables point to Minikube:</p>
<pre><code class="language-sbtshell">eval $(minikube docker-env)
</code></pre>

<p>We can check if Minikube is up and running with the following command:</p>
<pre><code class="language-sbtshell">$ kubectl get nodes
NAME       STATUS    ROLES     AGE       VERSION
minikube   Ready     &lt;none&gt;    1m        v1.8.0
</code></pre>

<p>To figure out your Minikube IP you can utilise the following command:</p>
<pre><code class="language-sbtshell">$ echo "http://$(minikube ip)"
http://192.168.99.100
</code></pre>

<p>It is also important to enable the Ingress addon:</p>
<pre><code class="language-sbtshell">minikube addons enable ingress
</code></pre>

<p>We need to launch sbt:</p>
<pre><code class="language-sbtshell">$ sbt
</code></pre>

<p>After which we can publish the images locally (you might want to grab a coffee after executing this):</p>
<pre><code class="language-sbtshell">docker:publishLocal
</code></pre>

<p>Underneath, <a href="https://github.com/sbt/sbt-native-packager" target="_blank" rel="noopener noreferrer">SBT Native Packager</a> is being used.
Check out its <a href="http://www.scala-sbt.org/sbt-native-packager/" target="_blank" rel="noopener noreferrer">documentation</a> for Docker related configurations.</p>

<p>Publishing to a Docker Registry is also possible by defining the <code class="language-plaintext highlighter-rouge">dockerRepository</code> sbt setting in the project and after authenticating to the registry, see <a href="https://developer.lightbend.com/docs/lightbend-orchestration-kubernetes/latest/building.html#publishing-to-a-docker-registry" target="_blank" rel="noopener noreferrer">Publishing to a Docker Registry</a>.
After doing so you can execute the publish command:</p>
<pre><code class="language-sbtshell">docker:publish
</code></pre>

<p>Our Docker images should then be available:</p>
<pre><code class="language-sbtshell">$ docker images
REPOSITORY             TAG                 IMAGE ID            CREATED             SIZE
orderimpl              1.0-SNAPSHOT        e9be41c50eb2        32 seconds ago      159MB
itemimpl               1.0-SNAPSHOT        357a9d546593        9 minutes ago       159MB
frontend               1.0-SNAPSHOT        7251c13a5373        6 days ago          141MB
</code></pre>

<p>As for the <a href="https://github.com/lightbend/reactive-app-maven-plugin" target="_blank" rel="noopener noreferrer">Maven equivalent plugin</a>, the Docker images can be build by executing:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mvn install
</code></pre></div></div>

<h2 id="locally-deploying-to-kubernetes-using-minikube">Locally deploying to Kubernetes using Minikube</h2>
<p>For development we can make use of an sbt task for deploying everything to Kubernetes using Minikube.
But before that, we need to do a couple of things.
We first need to set up Lightbend’s <a href="https://github.com/lightbend/reactive-sandbox" target="_blank" rel="noopener noreferrer">Reactive Sandbox</a> which is a Docker image that contains the usual components used when developing reactive applications using the Lightbend frameworks:</p>
<ul>
  <li>Cassandra</li>
  <li>Elasticsearch</li>
  <li>Kafka</li>
  <li>ZooKeeper</li>
</ul>

<p>We will use <a href="https://www.helm.sh" target="_blank" rel="noopener noreferrer">Helm</a>, a package manager for Kubernetes, to set it up.
Install instructions of Helm are available on the <a href="https://github.com/kubernetes/helm" target="_blank" rel="noopener noreferrer">GitHub repository</a>.
For Mac for example you can install it using brew:</p>
<pre><code class="language-sbtshell">$ brew install kubernetes-helm
</code></pre>

<p>With Helm we can then install the Reactive Sandbox:</p>
<pre><code class="language-sbtshell">helm init
helm repo add lightbend-helm-charts https://lightbend.github.io/helm-charts
helm update
helm install lightbend-helm-charts/reactive-sandbox --name reactive-sandbox
</code></pre>

<p>All set up, we can now utilise an sbt command to deploy all our services to Minikube!</p>

<p>Start sbt in the root of your project:</p>
<pre><code class="language-sbtshell">$ sbt
</code></pre>

<p>And deploy everything to Minikube using a sbt task that comes with the sbt-reactive-app plugin.
The task however is not yet supported on Windows unfortunately.</p>
<pre><code class="language-sbtshell">deploy minikube
</code></pre>

<p>During the setup we encountered a connection initialisation error of Helm:</p>
<pre><code class="language-sbtshell">Cannot initialize Kubernetes connection: Get http://localhost:8080/api: dial tcp 127.0.0.1:8080: getsockopt: connection refused
</code></pre>

<p>We found a solution for this in the following Helm GitHub issue: <a href="https://github.com/kubernetes/helm/issues/2464#issuecomment-381101015" target="_blank" rel="noopener noreferrer">Tiller pods can’t connect to k8s apiserver #2464</a>.</p>
<pre><code class="language-sbtshell">$ kubectl --namespace=kube-system create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=kube-system:default
</code></pre>

<p>If all went well your application should be accessible at <code class="language-plaintext highlighter-rouge">https://192.168.99.100</code>.
You can use the Minikube dashboard to inspect everything at <code class="language-plaintext highlighter-rouge">http://192.168.99.100:30000</code>.</p>

<p style="text-align: center;">
  <img class="image" style="width: 100%; max-width: 550px" src="/img/lagom-kubernetes/frontend.png" alt="Frontend" />
</p>

<p>Note that you can also deploy a single module instead of all of them.
For example if we only want to deploy the frontend, you simply switch to the specific project before running the command:</p>
<pre><code class="language-sbtshell">$ sbt
[info] Loading global plugins from /Users/yannickdeturck/.sbt/0.13/plugins
[info] Loading project definition from /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/project
[info] Set current project to lagom-shop-scala (in build file:/Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/)
&gt; projects
[info] In file:/Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/
[info] 	   common
[info] 	   frontend
[info] 	   itemApi
[info] 	   itemImpl
[info] 	   lagom-internal-meta-project-cassandra
[info] 	   lagom-internal-meta-project-kafka
[info] 	   lagom-internal-meta-project-service-locator
[info] 	 * lagom-shop-scala
[info] 	   orderApi
[info] 	   orderImpl
&gt; project frontend
[info] Set current project to frontend (in build file:/Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/)
[frontend] $ deploy minikube
[info] Wrote /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/frontend/target/scala-2.12/frontend_2.12-1.0-SNAPSHOT.pom
[info] Packaging /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/frontend/target/scala-2.12/frontend_2.12-1.0-SNAPSHOT-sources.jar ...
[info] Done packaging.
[info] Packaging /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/frontend/target/scala-2.12/frontend_2.12-1.0-SNAPSHOT.jar ...
[info] Done packaging.
[info] Wrote /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/common/target/scala-2.12/common_2.12-1.0-SNAPSHOT.pom
[info] Wrote /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/item-api/target/scala-2.12/itemapi_2.12-1.0-SNAPSHOT.pom
[info] Wrote /Users/yannickdeturck/Documents/Git-projects/lagom-shop-scala/order-api/target/scala-2.12/orderapi_2.12-1.0-SNAPSHOT.pom
13:23:14.079 [pool-7-thread-1] DEBUG com.lightbend.lagom.internal.api.tools.ServiceDetector - Loading service discovery class: FrontendLoader
[info] Sending build context to Docker daemon  54.52MB
[info] Step 1/9 : FROM openjdk:8-jre-alpine
[info]  ---&gt; b1bd879ca9b3
[info] Step 2/9 : RUN /sbin/apk add --no-cache bash
[info]  ---&gt; Using cache
[info]  ---&gt; 193af79a4475
[info] Step 3/9 : WORKDIR /opt/docker
[info]  ---&gt; Using cache
[info]  ---&gt; 741d2377c4e8
[info] Step 4/9 : ADD --chown=daemon:daemon opt /opt
[info]  ---&gt; Using cache
[info]  ---&gt; d7884eead001
[info] Step 5/9 : USER daemon
[info]  ---&gt; Using cache
[info]  ---&gt; cdedfe6fc10c
[info] Step 6/9 : ENTRYPOINT []
[info]  ---&gt; Using cache
[info]  ---&gt; 2db1227ffe9e
[info] Step 7/9 : CMD []
[info]  ---&gt; Using cache
[info]  ---&gt; bd147ead79fd
[info] Step 8/9 : COPY rp-start /rp-start
[info]  ---&gt; Using cache
[info]  ---&gt; 340110c7c251
[info] Step 9/9 : LABEL com.lightbend.rp.app-name="frontend" com.lightbend.rp.applications.0.name="default" com.lightbend.rp.applications.0.arguments.0="/rp-start" com.lightbend.rp.applications.0.arguments.1="bin/frontend" com.lightbend.rp.app-version="1.0-SNAPSHOT" com.lightbend.rp.app-type="lagom" com.lightbend.rp.config-resource="rp-application.conf" com.lightbend.rp.modules.akka-cluster-bootstrapping.enabled="false" com.lightbend.rp.modules.akka-management.enabled="false" com.lightbend.rp.modules.common.enabled="true" com.lightbend.rp.modules.play-http-binding.enabled="true" com.lightbend.rp.modules.secrets.enabled="false" com.lightbend.rp.modules.service-discovery.enabled="true" com.lightbend.rp.modules.status.enabled="false" com.lightbend.rp.endpoints.0.name="http" com.lightbend.rp.endpoints.0.protocol="http" com.lightbend.rp.endpoints.0.ingress.0.type="http" com.lightbend.rp.endpoints.0.ingress.0.ingress-ports.0="80" com.lightbend.rp.endpoints.0.ingress.0.ingress-ports.1="443" com.lightbend.rp.endpoints.0.ingress.0.paths.0="/" com.lightbend.rp.sbt-reactive-app-version="1.1.0"
[info]  ---&gt; Using cache
[info]  ---&gt; 7251c13a5373
[info] Successfully built 7251c13a5373
[info] Successfully tagged frontend:1.0-SNAPSHOT
[info] Built image frontend:1.0-SNAPSHOT
[info] deployment.apps "frontend-v1-0-snapshot" deleted
[info] service "frontend" deleted
[info] ingress.extensions "frontend" deleted
[info] deployment.apps "frontend-v1-0-snapshot" created
[info] service "frontend" created
[info] ingress.extensions "frontend" created
[success] Total time: 19 s, completed May 11, 2018 1:23:31 PM
</code></pre>

<p>We can inspect everything with <code class="language-plaintext highlighter-rouge">kubectl</code>:</p>

<pre><code class="language-sbtshell">$ kubectl get pods
NAME                                     READY     STATUS    RESTARTS   AGE
frontend-v1-0-snapshot-cbdbdb68b-rbrrx   1/1       Running   2          6d
reactive-sandbox-74fd955ddd-cjpw8        1/1       Running   7          6d

$ kubectl get services
NAME                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)                         AGE
frontend                         ClusterIP   10.103.128.78    &lt;none&gt;        10000/TCP                       6d
item                             ClusterIP   10.109.117.169   &lt;none&gt;        10000/TCP,10001/TCP,10002/TCP   6d
kubernetes                       ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP                         6d
reactive-sandbox-cassandra       ClusterIP   None             &lt;none&gt;        9042/TCP                        6d
reactive-sandbox-elasticsearch   ClusterIP   None             &lt;none&gt;        9200/TCP                        6d
reactive-sandbox-kafka           ClusterIP   None             &lt;none&gt;        9092/TCP                        6d
reactive-sandbox-zookeeper       ClusterIP   None             &lt;none&gt;        2181/TCP                        6d

$ kubectl get ing
NAME       HOSTS     ADDRESS   PORTS     AGE
frontend   *                   80        6d
item       *                   80        6d

$ kubectl get deploy
NAME                     DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
frontend-v1-0-snapshot   1         1         1            1           6d
reactive-sandbox         1         1         1            1           6d
</code></pre>

<p>There is currently no equivalent for Maven to deploy everything to Minikube in one simple command.
In the next section however, we will look at how we can utilise the reactive-cli tool for generating resource and configuration files, and deploying everything to Kubernetes which is also the way to go for development in this case.</p>

<h2 id="generating-kubernetes-resources-for-production">Generating Kubernetes resources for production</h2>
<p>The following workflow could also be used for development but it is more suited for deploying to your production environment as the <code class="language-plaintext highlighter-rouge">deploy minikube</code> workflow in the previous section simplifies a lot of things for you.</p>

<p>We will make use of the <a href="https://github.com/lightbend/reactive-cli" target="_blank" rel="noopener noreferrer">reactive-cli</a> command-line tool to have it generate the Kubernetes resource and configuration files.
Installing is easy, as described in the <a href="https://developer.lightbend.com/docs/lightbend-orchestration-kubernetes/latest/cli-installation.html" target="_blank" rel="noopener noreferrer">documentation</a>.
For Mac for example we can do this using Homebrew:</p>
<pre><code class="language-sbtshell">brew tap lightbend/tools &amp;&amp; brew install lightbend/tools/reactive-cli
</code></pre>

<p>Verifying if it was installed correctly can be done by checking the version:</p>
<pre><code class="language-sbtshell">$ rp version
rp (Reactive CLI) 1.1.1
jq support: Unavailable
</code></pre>

<p>Now we can utilise it to generate Kubernetes resources.
In the previous section we deployed our frontend and item service but we also have our order service to deploy.
Let us generate the Kubernetes resources and deploy it to Minikube.</p>

<pre><code class="language-sbtshell">$ rp generate-kubernetes-resources "orderimpl:1.0-SNAPSHOT" --generate-services --generate-pod-controllers --pod-controller-replicas 2 --env JAVA_OPTS="-Dplay.http.secret.key=simple"
---
apiVersion: "apps/v1beta2"
kind: Deployment
metadata:
  name: "order-v1-0-snapshot"
  labels:
    appName: order
    appNameVersion: "order-v1-0-snapshot"
spec:
  replicas: 2
  selector:
    matchLabels:
      appNameVersion: "order-v1-0-snapshot"
  template:
    metadata:
      labels:
        appName: order
        appNameVersion: "order-v1-0-snapshot"
    spec:
      restartPolicy: Always
      containers:
        - name: order
          image: "orderimpl:1.0-SNAPSHOT"
          imagePullPolicy: IfNotPresent
          env:
            - name: "JAVA_OPTS"
              value: "-Dplay.http.secret.key=simple"
            - name: "RP_APP_NAME"
              value: order
            - name: "RP_APP_TYPE"
              value: lagom
            - name: "RP_APP_VERSION"
              value: "1.0-SNAPSHOT"
            - name: "RP_DYN_JAVA_OPTS"
              value: "-Dakka.discovery.kubernetes-api.pod-namespace=$RP_NAMESPACE"
            - name: "RP_ENDPOINTS"
              value: "HTTP,AKKA_REMOTE,AKKA_MGMT_HTTP"
            - name: "RP_ENDPOINTS_COUNT"
              value: "3"
            - name: "RP_ENDPOINT_0_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_0_BIND_PORT"
              value: "10000"
            - name: "RP_ENDPOINT_0_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_0_PORT"
              value: "10000"
            - name: "RP_ENDPOINT_1_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_1_BIND_PORT"
              value: "10001"
            - name: "RP_ENDPOINT_1_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_1_PORT"
              value: "10001"
            - name: "RP_ENDPOINT_2_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_2_BIND_PORT"
              value: "10002"
            - name: "RP_ENDPOINT_2_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_2_PORT"
              value: "10002"
            - name: "RP_ENDPOINT_AKKA_MGMT_HTTP_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_AKKA_MGMT_HTTP_BIND_PORT"
              value: "10002"
            - name: "RP_ENDPOINT_AKKA_MGMT_HTTP_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_AKKA_MGMT_HTTP_PORT"
              value: "10002"
            - name: "RP_ENDPOINT_AKKA_REMOTE_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_AKKA_REMOTE_BIND_PORT"
              value: "10001"
            - name: "RP_ENDPOINT_AKKA_REMOTE_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_AKKA_REMOTE_PORT"
              value: "10001"
            - name: "RP_ENDPOINT_HTTP_BIND_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_HTTP_BIND_PORT"
              value: "10000"
            - name: "RP_ENDPOINT_HTTP_HOST"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_ENDPOINT_HTTP_PORT"
              value: "10000"
            - name: "RP_JAVA_OPTS"
              value: "-Dconfig.resource=rp-application.conf -Dakka.discovery.method=kubernetes-api -Dakka.management.cluster.bootstrap.contact-point-discovery.effective-name=order -Dakka.management.cluster.bootstrap.contact-point-discovery.required-contact-point-nr=2 -Dakka.discovery.kubernetes-api.pod-label-selector=appName=%s"
            - name: "RP_KUBERNETES_POD_IP"
              valueFrom:
                fieldRef:
                  fieldPath: "status.podIP"
            - name: "RP_KUBERNETES_POD_NAME"
              valueFrom:
                fieldRef:
                  fieldPath: "metadata.name"
            - name: "RP_MODULES"
              value: "akka-cluster-bootstrapping,akka-management,common,play-http-binding,service-discovery,status"
            - name: "RP_NAMESPACE"
              valueFrom:
                fieldRef:
                  fieldPath: "metadata.namespace"
            - name: "RP_PLATFORM"
              value: kubernetes
          ports:
            - containerPort: 10000
              name: http
            - containerPort: 10001
              name: "akka-remote"
            - containerPort: 10002
              name: "akka-mgmt-http"
          volumeMounts: []
          command:
            - "/rp-start"
          args:
            - "bin/orderimpl"
          readinessProbe:
            httpGet:
              path: "/platform-tooling/ready"
              port: "akka-mgmt-http"
            periodSeconds: 10
          livenessProbe:
            httpGet:
              path: "/platform-tooling/healthy"
              port: "akka-mgmt-http"
            periodSeconds: 10
            initialDelaySeconds: 60
      volumes: []
---
apiVersion: v1
kind: Service
metadata:
  labels:
    appName: order
  name: order
spec:
  ports:
    - name: http
      port: 10000
      protocol: TCP
      targetPort: 10000
    - name: "akka-remote"
      port: 10001
      protocol: TCP
      targetPort: 10001
    - name: "akka-mgmt-http"
      port: 10002
      protocol: TCP
      targetPort: 10002
  selector:
    appName: order
</code></pre>

<p>You could store the generated resources and tune it, but it is also possible to just generate everything that is necessary and just deploy it right away by chaining <code class="language-plaintext highlighter-rouge">kubectl apply</code>:</p>
<pre><code class="language-sbtshell">$ rp generate-kubernetes-resources "orderimpl:1.0-SNAPSHOT" --generate-services --generate-pod-controllers --pod-controller-replicas 2 --env JAVA_OPTS="-Dplay.http.secret.key=simple" | kubectl apply -f -
deployment.apps "order-v1-0-snapshot" created
service "order" created
</code></pre>

<p>We can verify whether it is up and running:</p>
<pre><code class="language-sbtshell">$ kubectl get deployments
NAME                     DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE
frontend-v1-0-snapshot   1         1         1            1           6d
order-v1-0-snapshot      2         2         2            2           6m
reactive-sandbox         1         1         1            1           6d

$ kubectl get pods
NAME                                     READY     STATUS    RESTARTS   AGE
frontend-v1-0-snapshot-cbdbdb68b-mwfqq   1/1       Running   1          50m
order-v1-0-snapshot-5884754595-65wxd     1/1       Running   0          4m
order-v1-0-snapshot-5884754595-wdbng     1/1       Running   0          4m
reactive-sandbox-74fd955ddd-cjpw8        1/1       Running   7          6d
</code></pre>

<h2 id="conclusion">Conclusion</h2>
<p>Upgrading to Lagom 1.4.x and Play 2.6 went pretty smooth as the migration guides of Lightbend cover mostly everything in detail as usual.</p>

<p>The orchestration tools make it pretty easy to test your Lagom application running in Kubernetes locally while still having the possibility to fine-tune the generated resource and configuration files.
Integrating the tool suite into our project went smoothly.
Kubernetes has gained a lot of popularity lately and with this, Lagom shows that it wants to embrace Kubernetes to deploy your applications onto next to ConductR.</p>

<p>The single <code class="language-plaintext highlighter-rouge">deploy minikube</code> command is not yet supported on Windows but we imagine that it will be in the near future.
Windows users can still utilise the <code class="language-plaintext highlighter-rouge">reactive-cli</code> command-line tool to generate the resource and configuration files and deploy it themselves via <code class="language-plaintext highlighter-rouge">kubectl</code> on their Minikube.
Maven users will only need to wait a little bit longer to take advantage of most things the tool suite has to offer as the plugin is nearing its first release version.</p>

<h2 id="extra-resources">Extra resources</h2>
<ul>
  <li><a href="https://github.com/yannickdeturck/lagom-shop-scala" target="_blank" rel="noopener noreferrer">Our Lagom Shop Scala application GitHub repository</a></li>
  <li><a href="https://developer.lightbend.com/docs/lightbend-orchestration-kubernetes/latest/index.html" target="_blank" rel="noopener noreferrer">Lightbend Orchestration Documentation</a></li>
  <li><a href="https://github.com/lagom/online-auction-scala/blob/master/KUBERNETES.md" target="_blank" rel="noopener noreferrer">Kubernetes instructions for the Lagom online-auction-scala application</a></li>
  <li><a href="https://github.com/fsat/hello-reactive-tooling" target="_blank" rel="noopener noreferrer">Hello-World for Lightbend Orchestration for Kubernetes for a sample Play application</a></li>
  <li><a href="/microservices/2016/04/22/Lagom-First-Impressions-and-Initial-Comparison-to-Spring-Cloud.html" target="_blank" rel="noopener noreferrer">Lagom: First Impressions and Initial Comparison to Spring Cloud</a></li>
  <li><a href="/microservices/2017/02/01/Lagom-1-2.html" target="_blank" rel="noopener noreferrer">Lagom 1.2: What’s new?</a></li>
  <li><a href="https://www.lagomframework.com/documentation/" target="_blank" rel="noopener noreferrer">Lagom Documentation</a></li>
  <li><a href="https://kubernetes.io/docs/home/" target="_blank" rel="noopener noreferrer">Kubernetes Documentation</a></li>
</ul>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/orchestration/2018/05/22/lagom-1-4-and-kubernetes-orchestration.html&title=Lagom 1.4 and Kubernetes orchestration&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=Lagom 1.4 and Kubernetes orchestration&url=https://ordina-jworks.github.io/orchestration/2018/05/22/lagom-1-4-and-kubernetes-orchestration.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/orchestration/2018/05/22/lagom-1-4-and-kubernetes-orchestration.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/yannick-de-turck/" class="image spotlight-image" title="">
            <img src="/img/author/yannick-de-turck.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Yannick is a principal Java consultant and practice manager at Ordina Belgium. He’s passionate about everything Java, Spring and cloud related as well as reactive programming, Kotlin, Lightbend technologies, software architectures, and coaching and enabling other colleagues.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2023 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/lagom-kubernetes.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
