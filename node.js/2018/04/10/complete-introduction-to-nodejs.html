<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Complete Introduction to NodeJs - Michael Vervloet">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/complete-introduction-node.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/node.js/2018/04/10/complete-introduction-to-nodejs.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="Complete Introduction to NodeJs - Michael Vervloet"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/complete-introduction-node.png"/>

    
    <title>Complete Introduction to NodeJs - Michael Vervloet &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/meet-the-team">Meet the team</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="https://join.ordina-jworks.io/">JOIN</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>Complete Introduction to NodeJs</h2>
                

                
                    Posted Apr 10, 2018


    in <a href="/categories/node.js/">Node.js</a>



    by
    
        <a href="/author/michael-vervloet/">Michael Vervloet</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/node.js/">Node.js</a>, 
    
        <a href="/tags/tutorial/">Tutorial</a>, 
    
        <a href="/tags/javascript/">JavaScript</a>
    

                

                

            </div>
        </header>
    </section>


    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <h2 id="what-is-node">What Is node</h2>
<p>NodeJs is a program that let’s you run JavaScript code on your machine without the need of a browser.
Underneath the surface of node is the V8 JavaScript runtime which is the engine that allows your browser to run JavaScript code.
On top of that, node adds some extra functionality to create server side applications
(for example <code class="language-plaintext highlighter-rouge">fs</code> to interact with the file system, <code class="language-plaintext highlighter-rouge">http</code> or <code class="language-plaintext highlighter-rouge">https</code> to send and receive http calls, <code class="language-plaintext highlighter-rouge">net</code> for tcp streams, and many more).</p>

<h2 id="use-cases">Use cases:</h2>
<p><strong>Real time applications (chat, stocks, IoT)</strong><br />
The event based nature of NodeJs and ‘keep-alive’ connections makes it ideal for real time applications, whenever an event occurs,
for example a chat message being received or a stock price being updated, it can emit an event on its connected sockets to update the client’s chat screen or stocks chart.</p>

<p><strong>REST APIs</strong><br />
This will be a topic on its own, but with frameworks built on top of NodeJs like Express or Nest it is really easy to get a REST API up and running in no time at all.</p>

<p><strong>Serverless:</strong><br />
NodeJs is supported with almost any serverless provider (Amazon Lambda, Azure functions, Google Cloud functions, …).
So developers can focus on their code and business logic instead of maintaining and setting up complicated server architectures.</p>

<p><strong>File uploading:</strong> <br />
When writing applications that depend a lot on network access and accessing files on the disk we have to keep an eye on how the data is being transferred back and forward.
For ultimate efficiency, especially when dealing with large sets of data, we need to be able to access that data piece by piece.
When that happens, we can start manipulating that data as soon as it arrives at the server.
Instead of holding it in memory until all chunks have arrived and writing it to disk, node can for example create a writable stream on the disk and write the chunks directly to the files without keeping them in memory and without blocking the entire application.
This way it can also receive multiple files at the same time.</p>

<h2 id="benefits-of-javascript-across-the-stack">Benefits of Javascript across the stack</h2>
<p>Not only does it make development quite a bit faster and easier by having a large community with lots of reusable code for your application (npm).
It also lowers the barriers between frontend and backend developers by using the same programming language over the entire stack.
So more efficiency and faster, leaner development which in turn means lower development costs.</p>

<p>Also worth noting is that JavaScript is currently THE most popular programming language <a href="https://insights.stackoverflow.com/survey/2018/?utm_source=Iterable&amp;utm_medium=email&amp;utm_campaign=dev-survey-2018-promotion#most-popular-technologies" target="blank" rel="noopener noreferrer">According to StackOverflow</a>,
so more developers will be able to easily understand and contribute to the application if needed.
Another important criteria: when it comes to cloud hosting,
RAM is probably the main influencing factor when it comes to pricing and since node is designed and encourages developers to write programs to use as less memory as possible it is often a cheaper alternative.</p>

<h2 id="multithreading">Multithreading</h2>
<p>This is usually a big issue/talking point when it comes to node.</p>

<p>In short: each NodeJs process is single threaded. 
If you want multiple threads, you have to have multiple processes as well.
You could say that because of that, NodeJs encourages you to implement microservices when dealing with these larger and complicated applications.
Which is a good thing since it makes not only your entire application but also each process individually very scalable.
The downside is that this might introduce some added complexity to your application.
But with Node’s lively modular ecosystem (npm) you can imagine there are already solutions to make setting this up a lot easier, (i.e. Moleculer, Seneca, …).</p>

<p>An important characteristic of microservices is “shared nothing”.
Node has a shared-nothing model:</p>
<blockquote>
  <p>A shared-nothing architecture (SN) is a distributed-computing architecture in which each node is independent and self-sufficient,
and there is no single point of contention across the system. More specifically, none of the nodes share memory or disk storage.
The advantages of SN architecture versus a central entity that controls the network (a controller-based architecture) include eliminating any single point of failure,
allowing self-healing capabilities and providing an advantage with offering non-disruptive upgrade.
A shared-nothing architecture (SN) is a distributed-computing architecture in which each node is independent and self-sufficient,
and there is no single point of contention across the system. More specifically, none of the nodes share memory or disk storage.
The advantages of SN architecture versus a central entity that controls the network (a controller-based architecture) include eliminating any single point of failure,
 allowing self-healing capabilities and providing an advantage with offering non-disruptive upgrade.</p>
</blockquote>

<p>(src: <a href="https://en.wikipedia.org/wiki/Shared-nothing_architecture" target="blank" rel="noopener noreferrer">Wikipedia</a>)</p>

<p>Additionally, node has some other features to make use of multiple cores like for example the cluster:
a single instance of NodeJs runs in a single thread. 
To take advantage of multi-core systems, the user will sometimes want to launch a cluster of NodeJs processes to handle the load.
The cluster module allows easy creation of child processes that share server ports and automatically load balances across these processes.</p>

<h2 id="blocking-vs-non-blocking">Blocking vs. Non-Blocking</h2>
<p>As we’ve said before, NodeJs encourages you to take advantage of non-blocking code (like JavaScript promises).
To demonstrate how this works, I’ll give you an example in pseudo code for reading a file from the filesystem.</p>

<p><strong>Blocking:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    read file from filesystem,
    print content
    do something else`
</code></pre></div></div>

<p><strong>Non-Blocking:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    read file from filesystem
        Whenever we're complete, print contents (callback)
    do something else
</code></pre></div></div>

<p><strong>Difference:</strong><br />
When reading two files, the blocking code starts reading the file.
In case of a large file, let’s say this takes 5 seconds.
After the file has been read, it logs its content. 
Then it starts reading the second file which again takes around 5 seconds and the content gets logged.</p>

<p>In the non-blocking code, we tell the processor to start reading the file, and when it’s done, to “let us know” (resolve promise) so that we can do more stuff with it.
At the same time since there is another file to be read, we start reading the second file and again tell the processor to notify us when it is ready so that we can do stuff with it.
Whenever a ‘Promise’ of reading a file resolves, its callback (in our case, the pseudo code: <code class="language-plaintext highlighter-rouge">print contents</code>) gets executed
(this also means that, when file #2 takes less time to be read, it will be resolved and printed first which is something you might want to keep in mind).</p>

<p><img src="/img/non-blocking.png" alt="Blocking vs Non-blocking" width="100%" /></p>

<h2 id="v8-runtime-engine">V8 Runtime Engine</h2>
<p>Node uses Google Chrome’s V8 runtime engine to run JavaScript code, we’ve shown this video in one of our previous blog posts before,
but since it might be useful to know how it works under the hood I’ve included the video once more.
When it comes to node development there are some differences, since we don’t get events from the DOM.
In node we can get them from the NodeJs event emitter but the way it works stays the same.
It has some useful tips like avoiding to block the call stack.</p>
<iframe src="https://player.vimeo.com/video/96425312" width="100%" height="360" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>

<p><a href="https://vimeo.com/96425312" target="blank" rel="noopener noreferrer">Philip Roberts: Help, I'm stuck in an event-loop.</a></p>

<h2 id="installing-nodejs">Installing NodeJs</h2>
<p>Download the installer for your OS at <a href="https://nodejs.org/en/download/" target="blank" rel="noopener noreferrer">https://nodejs.org/en/download/</a>.
Or, if you are a Mac user and have brew installed you can install it with brew.</p>

<p>Open a terminal and run the following commands:</p>

<p>Install node<br />
<code class="language-plaintext highlighter-rouge">brew install node</code></p>

<p>Verify if node was successfully installed (should output your node’s version number)<br />
<code class="language-plaintext highlighter-rouge">node -v </code></p>

<h2 id="node-modules">Node Modules</h2>
<p>Previously I talked about one of the benefits of node being its vast ecosystem of open source code that you can exploit.
To avoid having to write the same common logic over and over again, node’s greatest feature is probably its modularity.
You can put common logic in a node module that you can reuse over and over again in different components of your projects or even reuse them in other projects.</p>

<h2 id="npm">NPM</h2>
<p>NPM or ‘Node Package Manager’ is an online registry for node modules. 
When you’ve written a useful module, why not share it with the world.
Whenever you’ve implemented some common logic that can be reused across projects, it is a common practice in the world of JavaScript development to make it Open Source and share it with other developers who might want to implement the same logic.
This way they don’t have to write it themselves which saves times and headaches.
Just like using other people’s modules might do for you.</p>

<p>Here are some useful npm commands to get you started:</p>

<p><code class="language-plaintext highlighter-rouge">npm init </code> <br />Start a new project. This creates a <code class="language-plaintext highlighter-rouge">package.json</code> file that keeps track of the installed modules (if you save them).</p>

<p><code class="language-plaintext highlighter-rouge">npm install &lt;module_name&gt;</code> <br />Downloads a module that is registered (by name) on the npm registry.
To see which modules modules are available, simply visit <a href="https://www.npmjs.com" target="blank" rel="noopener noreferrer">npmjs.com</a> and search for whatever you need.
The downloaded code will be saved in the <code class="language-plaintext highlighter-rouge">node_modules</code> directory. (Unless global install)</p>

<p><code class="language-plaintext highlighter-rouge">npm install &lt;module_name&gt; —save</code> <br /> installs and also updates your project’s dependencies in <code class="language-plaintext highlighter-rouge">package.json</code></p>

<p><code class="language-plaintext highlighter-rouge">npm install &lt;module_name&gt; —save-dev</code> <br /> installs and updates your project’s development dependencies in <code class="language-plaintext highlighter-rouge">package.json</code> (dependencies that you don’t need at runtime, i.e. testing frameworks like Jasmine or Karma, build frameworks like gulp or webpack, …)</p>

<p><code class="language-plaintext highlighter-rouge">npm install &lt;module_name&gt; --global</code> <br /> installs the package globally, packages with command line interfaces like gulp-cli, angular-cli are installed globally.</p>

<p><code class="language-plaintext highlighter-rouge">npm uninstall</code> <br /> uninstalls packages from your project</p>

<p><code class="language-plaintext highlighter-rouge">npm update</code> <br /> updates your packages</p>

<p>For a full overview of npm commands and further documentation of npm, check out this page: <a href="https://docs.npmjs.com/" target="blank" rel="noopener noreferrer">https://docs.npmjs.com/</a></p>

<h2 id="node-repl">Node REPL</h2>
<p>Once you have installed node you can open a terminal window and run node.
This will return a node REPL where you can run JavaScript code. For example:<br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function add(a, b){ return a + b } &lt;enter&gt;
add(4, 7) &lt;enter&gt;
// Returns 11
</code></pre></div></div>
<p>To terminate the REPL hit <code class="language-plaintext highlighter-rouge">CTRL + C</code>.</p>

<h2 id="hello-world">Hello World</h2>
<p>Using the REPL can be useful sometimes, but when we want to make some persistent programs,
we might want to write our code in a file and run the content of that file.</p>

<p>In this example we’ll create a <code class="language-plaintext highlighter-rouge">helloworld.js</code> file.
Create it in your favourite IDE or run <code class="language-plaintext highlighter-rouge">touch helloworld.js</code> and open it in your IDE or Vim/nano/…</p>

<p>To keep it simple for this first project, we’ll simply make a program that logs ‘hello’ and ‘world’ in your terminal,
we’ll log them separately just to show you that there’s different ways to log data with node.</p>

<p><code class="language-plaintext highlighter-rouge">helloworld.js</code><br /></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// process is a global variable that refers to the current node process you are running,</span>
<span class="c1">// it has a stdout property that has a write method which we can call to output data.</span>
<span class="nx">process</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// the \n creates a new line in the terminal</span>

<span class="c1">// or a bit simpler, the one we are used to from the browser, console.log</span>
<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">world</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="hello-world-async">Hello World Async</h2>

<p>An example of non-blocking code</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// after 2 secs, print world</span>
<span class="nf">setTimeout</span><span class="p">(</span> <span class="p">()</span><span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">world</span><span class="dl">'</span><span class="p">);</span> <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// prints  'hello' first, then 'world'</span>
</code></pre></div></div>

<p>When you’ve watched the video about how the V8 Engine works, you’ll know why ‘hello’ gets logged first and ‘world’ second:
What happens is:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">setTimeout</code> is added to the call stack</li>
  <li><code class="language-plaintext highlighter-rouge">setTimeout</code> has a timer and a callback, this fires up  V8’s timer Web API</li>
  <li>now that the Web API is taking care of the <code class="language-plaintext highlighter-rouge">setTimeout</code>, it gets removed from the call stack</li>
  <li><code class="language-plaintext highlighter-rouge">console.log</code> is added to the call stack, it logs ‘hello’, and removes <code class="language-plaintext highlighter-rouge">console.log</code> from the call stack</li>
  <li>once the timer has completed, it pushes the callback to the task queue</li>
  <li>since there are no more function calls on the call stack, the event loop adds the callback to the call stack</li>
  <li>finally, ‘world’ is printed.</li>
</ul>

<p>There’s no need for an additional thread to pause the program for 2 seconds and after that log ‘world’.
The V8 Engine handles this for us just like it does with any other async functionality in the browser.
So this is a very simple example of how non-blocking code works in NodeJs, the timeout did not block our code, ‘hello’ got logged right away.</p>

<h2 id="hello-module">Hello Module</h2>
<p>Now lets give you an example how to create a node module (a very simple and not a very useful one) but just to give you an idea of how you can export your code and use it in other files.</p>

<p>We’re going to create a module that has a log function which takes a parameter (name) and logs ‘hello <name>' to the console.
Then we'll import it in another file and call the function from there.</name></p>

<p><code class="language-plaintext highlighter-rouge">log.js</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// create our custom hello function</span>
<span class="kd">const</span> <span class="nx">log</span> <span class="o">=</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Hello </span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span> <span class="p">}</span>
<span class="c1">// export this functionality</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">log</span><span class="p">;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">hello.js</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// the way we import another module into our file is by using require(), require is a global module for node</span>
<span class="c1">// when requiring local modules (not the ones we install with npm), we give it the path relative to the current file,</span>
<span class="c1">// no need for extensions, since node looks for a .js file</span>
<span class="kd">var</span> <span class="nx">log</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./log</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// now that we have our functionality available in the log variable, we can use it</span>
<span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Mike</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// logs 'hello Mike' to the console</span>
</code></pre></div></div>

<p>To import modules that you’ve installed with npm, don’t specify a path, but give it the package’s name.
For example:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// this imports the express module from the express package if we installed it`</span>
<span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">express</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<p>To learn more about how to use <code class="language-plaintext highlighter-rouge">require</code> go check out this useful url: <a href="https://medium.freecodecamp.org/requiring-modules-in-node-js-everything-you-need-to-know-e7fbd119be8" target="blank" rel="noopener noreferrer">Requiring Modules</a>.</p>

<h2 id="hello-server">Hello Server</h2>
<p>Now that we know how to require other modules, let’s create a basic server application.
We’re not going to install any server frameworks (like Express) yet, instead we’ll require a module that comes with node.
Node has some built-in modules that you can use like <code class="language-plaintext highlighter-rouge">http</code> (HTTP server), <code class="language-plaintext highlighter-rouge">https</code>, <code class="language-plaintext highlighter-rouge">fs</code> (file system), <code class="language-plaintext highlighter-rouge">net</code> (TCP sockets), … <br />
(a list can be found here: <a href="https://www.w3schools.com/nodejs/ref_modules.asp" target="blank" rel="noopener noreferrer">https://www.w3schools.com/nodejs/ref_modules.asp</a>)</p>

<p>For this program, we’ll use node’s <code class="language-plaintext highlighter-rouge">http</code> module.</p>

<p><code class="language-plaintext highlighter-rouge">hello-server.js</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// import the http module (docs: https://nodejs.org/api/http.html)</span>
<span class="kd">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// we create a server that will send plaintext 'Hello World' back to the client and put it in a variable server</span>
<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">createServer</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/plain</span><span class="dl">'</span><span class="p">});</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">end</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello world</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// we tell the server to start listening on port 3000</span>
<span class="nx">server</span><span class="p">.</span><span class="nf">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="c1">// once the server has successfully started listening on port 3000</span>
    <span class="c1">// (if the port isn't already in use)</span>
    <span class="c1">// we'll log this to the console</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Server running at localhost:3000/</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div></div>
<p>You can now open our browser, visit <a href="localhost:3000" target="blank" rel="noopener noreferrer">localhost:3000</a> and should see our ‘Hello world’ response from the server.</p>

<h2 id="event-emitter">Event Emitter</h2>
<p>Another great feature that comes with NodeJs is the event emitter.
The event emitter allows us to emit and listen for named events,
whenever the EventEmitter emits an event all the functions attached to the named event are called synchronously.</p>

<p>It’s real simple, let us show you with an example:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// first we require the 'events' module that comes with node</span>
<span class="kd">const</span> <span class="nx">events</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">events</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// next we'll create a new instance of the events module's event emitter</span>
<span class="kd">const</span> <span class="nx">eventEmitter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">events</span><span class="p">.</span><span class="nc">EventEmitter</span><span class="p">();</span>

<span class="c1">// we'll tell the event emitter that we are going to listen for the 'hello' event</span>
<span class="c1">// and give it a callback function that gets called when the event is triggered</span>
<span class="nx">eventEmitter</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// as you can see, our callback function accepts a data parameter,</span>
  <span class="c1">// we'll check if the event was emitted with data and has a 'name' property, if so we log 'Hello name'</span>
  <span class="nf">if </span><span class="p">(</span><span class="nx">data</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Hello </span><span class="p">${</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c1">// if no data was passed to the callback, we'll simply log 'Hello world'</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello world</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// now that we are listening for the 'hello' event, we'll emit the event, once with data, and once without data</span>
<span class="nx">eventEmitter</span><span class="p">.</span><span class="nf">emit</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span><span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Mike</span><span class="dl">'</span><span class="p">});</span> <span class="c1">// logs 'Hello Mike'</span>
<span class="nx">eventEmitter</span><span class="p">.</span><span class="nf">emit</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// logs 'Hello world'</span>
</code></pre></div></div>

<h2 id="streams">Streams</h2>
<p>There are many ways that you can utilise readable/writable streams with NodeJs, for example the file system to read/write to files.
But to give you a simple example, let’s reuse our code from our hello server.
Since the request object is a readable stream and the response object is a writable stream,
we can create an application that pipes the data from the request, back to the response.
Let’s see it in action with an example:</p>

<p><code class="language-plaintext highlighter-rouge">streams.js</code></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nf">createServer</span><span class="p">((</span><span class="nx">request</span><span class="p">,</span> <span class="nx">response</span><span class="p">)</span><span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">res</span><span class="p">.</span><span class="nf">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">text/plain</span><span class="dl">'</span><span class="p">});</span>
  <span class="c1">// The request is a readable stream, this means that the connection isn't immediately closed,</span>
  <span class="c1">// the connection stays open for as long as the client keeps sending data.</span>
  <span class="c1">// Streams inherit from the event emitter, so we can listen for the request stream's 'readable' and 'end' events</span>
  <span class="c1">// the readable event is triggered whenever the request has sent a chunk of data that can be read.</span>
  <span class="nx">req</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">readable</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
      <span class="kd">let</span> <span class="nx">chunk</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
      <span class="c1">// as long as we can read chunks from the request, we write those chunks to the response</span>
      <span class="nf">while</span><span class="p">(</span><span class="kc">null</span> <span class="o">!==</span> <span class="p">(</span><span class="nx">chunk</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nf">read</span><span class="p">())){</span>
         <span class="c1">// we can keep writing to the writable response stream as long as the connection is open,</span>
         <span class="c1">// so we keep piping the readable data to the response</span>
          <span class="nx">response</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="c1">// you can test it with curl from the terminal by sending a 'hello' string as data,</span>
      <span class="c1">// simply run: curl -d 'hello' http://localhost:3000</span>
      <span class="c1">// the 'hello' string is being sent back to the client</span>
  <span class="p">});</span>

  <span class="nx">req</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
      <span class="c1">// once the request stream is closed, we also close the response stream</span>
      <span class="nx">response</span><span class="p">.</span><span class="nf">end</span><span class="p">();</span>
  <span class="p">});</span>

  <span class="cm">/*
	I've written it out completely to show you what is does,
	but in fact we can use the pipe method to refactor the request's 'on readable' in some much simpler code
	req.on('readable', ()=&gt;{
             request.pipe(response)
        })
   */</span>
<span class="p">});</span>

<span class="nx">server</span><span class="p">.</span><span class="nf">listen</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="p">()</span><span class="o">=&gt;</span><span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Server running at localhost:3000/</span><span class="dl">'</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<h2 id="cluster">Cluster</h2>
<p>A single instance of NodeJs runs in a single thread.
To take advantage of multi-core systems, the user will sometimes want to launch a cluster of NodeJs processes to handle the load.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// require the cluster module</span>
<span class="kd">const</span> <span class="nx">cluster</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">cluster</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// we'll set up a http server on all cpus and load balance between them</span>
<span class="kd">const</span> <span class="nx">http</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">http</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// we need to know the amount of cpus our machine has available,</span>
<span class="c1">// so we do this with the 'os' module's cpus method which returns an array of cpus, to get the amount we get the array's length</span>
<span class="kd">const</span> <span class="nx">numCPUs</span> <span class="o">=</span> <span class="nf">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">os</span><span class="dl">'</span><span class="p">).</span><span class="nf">cpus</span><span class="p">().</span><span class="nx">length</span><span class="p">;</span>

<span class="nf">if </span><span class="p">(</span><span class="nx">cluster</span><span class="p">.</span><span class="nx">isMaster</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// the cluster will first start up a master process that forks itself onto the other cpus and handles the load balancing between these workers</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Master </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">pid</span><span class="p">}</span><span class="s2"> is running`</span><span class="p">);</span>

  <span class="c1">// fork this process to a worker for every cpu that is left (note the &lt; and not &lt;=)</span>
  <span class="nf">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">numCPUs</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">cluster</span><span class="p">.</span><span class="nf">fork</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// when a worker dies, it emits an exit event</span>
  <span class="nx">cluster</span><span class="p">.</span><span class="nf">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">exit</span><span class="dl">'</span><span class="p">,</span> <span class="p">(</span><span class="nx">worker</span><span class="p">,</span> <span class="nx">code</span><span class="p">,</span> <span class="nx">signal</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`worker </span><span class="p">${</span><span class="nx">worker</span><span class="p">.</span><span class="nx">process</span><span class="p">.</span><span class="nx">pid</span><span class="p">}</span><span class="s2"> died`</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// if the cluster is not master, it (in this case) sets up our http server</span>
  <span class="c1">// workers can share any TCP connection</span>

  <span class="nx">http</span><span class="p">.</span><span class="nf">createServer</span><span class="p">((</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nf">end</span><span class="p">(</span><span class="dl">'</span><span class="s1">hello world</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">}).</span><span class="nf">listen</span><span class="p">(</span><span class="mi">8000</span><span class="p">);</span>

  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="s2">`Worker </span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">pid</span><span class="p">}</span><span class="s2"> started`</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>
<p>More information on clusters on <a href="https://nodejs.org/api/cluster.html" target="blank" rel="noopener noreferrer">https://nodejs.org/api/cluster.html</a></p>

<h2 id="finally">Finally</h2>
<p>So that’s it for this blog post. I hope it was useful to you.
If you have any suggestions or feel like I’ve forgotten to mention some important stuff, feel free to comment below.
I’m currently working on some follow-up tutorials:</p>
<ul>
  <li>Building REST APIs with NestJs (TypeScript),</li>
  <li>Microservices with NodeJs (Moleculer),</li>
  <li>Serverless with NodeJs</li>
</ul>

<p>Once these are finished I’ll add the links below, so stay tuned!</p>

        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/node.js/2018/04/10/complete-introduction-to-nodejs.html&title=Complete Introduction to NodeJs&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=Complete Introduction to NodeJs&url=https://ordina-jworks.github.io/node.js/2018/04/10/complete-introduction-to-nodejs.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/node.js/2018/04/10/complete-introduction-to-nodejs.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/michael-vervloet/" class="image spotlight-image" title="">
            <img src="/img/author/michael-vervloet.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Michael is a full stack JavaScript/TypeScript developer specialising himself in backend development with NodeJs and Express and has a solid background in frontend/hybrid mobile development. As a member of Ordina’s core ‘Internet of Things’ team he has collaborated on some challenging and innovative IoT applications.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordinabelgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2023 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/complete-introduction-node.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
