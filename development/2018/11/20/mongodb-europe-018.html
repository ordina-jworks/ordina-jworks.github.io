<!DOCTYPE html>
<!--suppress ALL -->
<html>
<head>
        <meta charset="utf-8">
    <meta name="description" content="We build innovative solutions with Java and JavaScript. To support this mission, we have several Competence Centers. From within those Competence Centers, we provide coaching to the employee and expert advice towards our customer. In order to keep in sync with the latest technologies and the latest trends, we frequently visit conferences around the globe.
">
    <meta name="keywords" content="Ordina,ORAJ,JWorks,Blog,Java,JavaScript,TypeScript,Angular,DevOps">
    <meta name="author" content="Ordina Belgium">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/img/favicons/favicon-128.png" sizes="128x128" />

    

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="MongoDB Europe 2018 - Chris De Bruyne, Nick Van Hoof and Jan Van der Veken">
    <meta name="twitter:description" content="Ordina JWorks Tech Blog">
    <meta name="twitter:image" content="http://ordina-jworks.github.io/img/2018-11-08-mongodb-europe-2018/main-image-mdbe.png"/>

    <!-- Facebook Open Graph -->
    <meta property="og:url" content="http://ordina-jworks.github.io/development/2018/11/20/mongodb-europe-018.html"/>
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="MongoDB Europe 2018 - Chris De Bruyne, Nick Van Hoof and Jan Van der Veken"/>
    <meta property="og:description" content="Ordina JWorks Tech Blog"/>
    <meta property="og:image" content="http://ordina-jworks.github.io/img/2018-11-08-mongodb-europe-2018/main-image-mdbe.png"/>

    
    <title>MongoDB Europe 2018 - Chris De Bruyne, Nick Van Hoof and Jan Van der Veken &mdash; Ordina JWorks Tech Blog</title>
    

        <!-- Styles -->
    <!-- Font awesome CSS -->
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <!-- Magnific Popup -->
    <link href="/css/magnific-popup.css" rel="stylesheet">
    <!-- Owl carousel -->
    <link href="/css/owl.carousel.css" rel="stylesheet">

    <!-- CSS for this page -->

    <!-- Syntax highlighting -->
    <link href="/css/syntax.css" rel="stylesheet">


    <!--[if lte IE 8]>
    <script src="/js/ie/html5shiv.js"></script><![endif]-->
    <link rel="stylesheet" href="/css/main.css"/>
    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/css/ie9.css"/><![endif]-->
    <!--[if lte IE 8]>
    <link rel="stylesheet" href="/css/ie8.css"/><![endif]-->

    <!-- Custom CSS. Type your CSS code in custom.css file -->
    <link href="/css/custom.css" rel="stylesheet">

    <!-- Vertical timeline -->
	<link rel="stylesheet" href="/css/vertical-timeline/style.css"> <!-- Resource style -->

    <!-- Favicon -->
    <link rel="shortcut icon" href="#">

    <script src="https://use.typekit.net/gzh0mbm.js"></script>
    <script>
        try {
            Typekit.load({async: true});
        } catch (e) {
        }
    </script>
</head>

<body>
<div id="header-image"></div>


<!-- Page Wrapper -->
<div id="page-wrapper">

        <!-- Header -->
    <header id="header">
        <h1>
            <a href="/">
                JWorks Tech Blog
            </a>
        </h1>

        <nav>
            <a href="#menu">Menu</a>
            <form action="/search/" method="get" class="header-search search-form">
                <input type="text" id="search-box-header" name="query" placeholder="Search &hellip;">
            </form>
        </nav>
    </header>

    <!-- Menu -->
    <nav id="menu">
        <div class="inner">
            <h2>Menu</h2>
            <ul class="links">
                <li class="menu-item"><a href="/">Home</a></li>
                <li class="menu-item"><a href="/about">About Us</a></li>
                <li class="menu-item"><a href="/jobs">Jobs</a></li>
                <li class="menu-item"><a href="/launch-your-career">Career</a></li>
                <li class="menu-item"><a href="/tech-radar">Tech Radar</a></li>
                <li class="menu-item"><a href="/search">Search</a></li>
                <li class="menu-item"><a href="/contact">Contact Us</a></li>
            </ul>
            <a href="#" class="close">Close</a>
        </div>
    </nav>

    <section id="banner">
        <header>
            <div class="inner">
                

                <h2>MongoDB Europe 2018</h2>
                

                
                    Posted Nov 20, 2018


    in <a href="/categories/development/">Development</a>



    by
    
        <a href="/author/chris-de-bruyne">Chris De Bruyne</a>
        
            
                , 
            
        
    
        <a href="/author/nick-van-hoof">Nick Van Hoof</a>
        
            
                 and 
        
        
    
        <a href="/author/jan-van-der-veken/">Jan Van der Veken</a>
        
    



    <br/>
    <i class="fa fa-tags"></i>
    
        <a href="/tags/development/">Development</a>, 
    
        <a href="/tags/mongodb/">MongoDB</a>, 
    
        <a href="/tags/dba/">DBA</a>, 
    
        <a href="/tags/data/">Data</a>, 
    
        <a href="/tags/kubernetes/">Kubernetes</a>, 
    
        <a href="/tags/conference/">Conference</a>
    

                

                

            </div>
        </header>
    </section>

    <section id="wrapper">
        <div class="inner">
            <section id="one" class="wrapper spotlight style1 post-body">
    <div class="inner" style="text-align: left;">
        <div class="content">
            <blockquote>
  <p>MongoDB Europe is a yearly conference where MongoDB shows off their latest features and new products.
This year the venue took place in Old Billingsgate Walk, London.
Jan, Nick and Chris wrote this blog post to summarize several of the given sessions.</p>
</blockquote>

<h1 id="table-of-contents">Table of contents</h1>
<ol>
  <li><a href="#atlas">Atlas</a></li>
  <li><a href="#mongodb-university">MongoDB University</a></li>
  <li><a href="#compass-aggregation-pipeline-builder">Compass Aggregation Pipeline Builder</a></li>
  <li><a href="#common-query-mistakes">Common query mistakes</a></li>
  <li><a href="#stitch">Stitch</a></li>
  <li><a href="#meet-the-experts">Meet the experts</a></li>
  <li><a href="#streaming-data-pipelines-with-mongodb-and-kafka-at-ao">Streaming data pipelines with MongoDB and Kafka at AO</a></li>
  <li><a href="#mongodb-enterprise-operator-for-kubernetes-at-amadeus">MongoDB Enterprise Operator for Kubernetes at Amadeus</a></li>
  <li><a href="#mongodb-charts">MongoDB Charts</a></li>
  <li><a href="#closing">Closing</a></li>
</ol>

<h1 id="atlas">Atlas</h1>
<p>(<a href="https://sched.co/FmAF" target="_blank" rel="noopener noreferrer">MongoDB Atlas for your Enterprise</a>, Vladislava Stevanovic &amp; Veronica Tudor)</p>

<p>Atlas is the database as a service offering (DBaaS) by MongoDB itself.
You can run your MongoDB in the cloud with the cloud provider of your choice, secured by default and automatically backed up.</p>

<h3 id="getting-started">Getting started</h3>
<p>It is very easy to get started since a free tier is provided for everyone and you can deploy with the cloud provider of your choice (Azure , GCP, AWS).
A cluster can be started for free in just a few clicks.</p>

<div style="text-align: center;">
  <img src="/img/2018-11-08-mongodb-europe-2018/create-mongodb-atlas-cluster.png" width="100%" />
</div>

<p>Start your own cluster: <a href="https://cloud.mongodb.com" target="_blank" rel="noopener noreferrer">https://cloud.mongodb.com</a></p>

<h3 id="cloud">Cloud</h3>
<p>MongoDB Atlas is a cross-platform database which you can run on Amazon Web Services, Google Cloud or Microsoft Azure. 
It provides you an availability map that shows you which users are served from where and what the expected latency is.</p>
<div style="text-align: center;">
  <img src="/img/2018-11-08-mongodb-europe-2018/global-clusters.png" width="100%" />
</div>

<h3 id="scalability">Scalability</h3>
<p>When your database grows it is easy to scale up or out.
You can scale up by increasing the size of the instance on which your database runs.
Scaling out is done by the process of sharding.
Here we are storing data of the same collection across multiple smaller partitions so we can distribute these partitions over multiple machines and increase read-write performance.
This way you do not run into the limitations of a single server.</p>

<p>To ensure that MongoDB stores data equally across shards you need the right strategy of choosing a partition key.</p>

<h3 id="high-availability">High availability</h3>
<p>When a primary node goes down, a new primary is chosen immediately by a system of voting.
All nodes vote on who should become the new primary. 
The node with the majority of votes becomes the new primary.
A general guideline is to have a replica set that consists of one primary node and at least two secondary nodes.
To ensure maximum uptime the procedure to recover from instance failures is completely automated.</p>

<h1 id="mongodb-university">MongoDB University</h1>

<p>With <a href="https://university.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB University</a>, Mongo has its own platform for online courses.
A lot of them are available for free.
You can pick out courses according to your needs or profession.
There are training tracks for Developers, DBA’s and everyone else…
The courses are ideal to get you started or to deepen your knowledge when you want to be more advanced.
If you want you can even get certified!
I speak from my own experience when I say that the University platform is great to work with, and the courses are very well taught.
Find all available resources here: <a href="https://university.mongodb.com/" target="_blank" rel="noopener noreferrer">https://university.mongodb.com/</a>.</p>

<h1 id="compass-aggregation-pipeline-builder">Compass Aggregation Pipeline Builder</h1>

<p>Recently the aggregation pipeline builder was introduced in <a href="https://www.mongodb.com/products/compass" target="_blank" rel="noopener noreferrer">MongoDB Compass</a>.
This allows you to create an aggregation pipeline step by step and that makes it easy to debug the pipeline along the way.
Let’s see an example: <br />
Suppose I have a collection which contains documents that represent a person, like this :
Here are two examples of elements in the collections:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nl">"_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5be40f6e7047ead15753d073"</span><span class="err">)</span><span class="p">,</span><span class="w">
	</span><span class="nl">"firstName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Didi"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"lastName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Verhoft"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"birthYear"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1996</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
	</span><span class="nl">"_id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">ObjectId(</span><span class="s2">"5be40f6e7047ead15753d074"</span><span class="err">)</span><span class="p">,</span><span class="w">
	</span><span class="nl">"firstName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Nick"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"lastName"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Van Hoof"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"birthYear"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1992</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p>A person has the fields lastName, firstName and birthYear (and of course for some people more info could be stored).
I want to build a pipeline with the following functionality:</p>
<ul>
  <li>I want to filter out all people that share my lastname “Van Hoof”</li>
  <li>Then I want to count how many times these people also share the same firstname and birthyear</li>
  <li>Next I want to group them by birthYear so that I can see how many people were named “Nick Van Hoof “ (my fullname) in 1992.</li>
  <li>Finally, I want them sorted on year in ascending order</li>
</ul>

<p>Filter all with last name  “Van Hoof” and group by lastName, firstName and year:</p>
<div style="text-align: center;">
  <img src="/img/2018-11-08-mongodb-europe-2018/aggregation-pipeline-builder-compose-1.png" width="100%" />
</div>

<p>Group by year and sort in ascending order:</p>
<div style="text-align: center;">
  <img src="/img/2018-11-08-mongodb-europe-2018/aggregation-pipeline-builder-compose-2.png" width="100%" />
</div>

<p>As you can see from the images above, Compass will show all the intermediary results. 
With one push of a button you can generate a command line query or the translation to a programming language.
Compass tells me the full aggregate will look like :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">([{</span><span class="na">$match</span><span class="p">:</span> <span class="p">{</span>
                      <span class="na">lastName</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">Van Hoof</span><span class="dl">"</span>
                    <span class="p">}},</span> <span class="p">{</span><span class="na">$group</span><span class="p">:</span> <span class="p">{</span>
                      <span class="na">_id</span><span class="p">:</span> <span class="p">{</span> 
                        <span class="dl">"</span><span class="s2">lastName</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">$lastName</span><span class="dl">"</span><span class="p">,</span>
                        <span class="dl">"</span><span class="s2">firstName</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$firstName</span><span class="dl">"</span><span class="p">,</span>
                        <span class="dl">"</span><span class="s2">year</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">$birthYear</span><span class="dl">"</span>
                      <span class="p">},</span>
                      <span class="na">count</span><span class="p">:</span> <span class="p">{</span>
                         <span class="na">$sum</span><span class="p">:</span> <span class="mi">1</span> 
                      <span class="p">}</span>
                    <span class="p">}},</span> <span class="p">{</span><span class="na">$group</span><span class="p">:</span> <span class="p">{</span>
                            <span class="dl">"</span><span class="s2">_id</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
                                <span class="dl">"</span><span class="s2">year</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$_id.year</span><span class="dl">"</span><span class="p">,</span>
                            <span class="p">},</span>
                            <span class="dl">"</span><span class="s2">occurences</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
                              <span class="dl">"</span><span class="s2">$push</span><span class="dl">"</span> <span class="p">:</span> <span class="p">{</span>
                                  <span class="dl">"</span><span class="s2">identity</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$_id</span><span class="dl">"</span><span class="p">,</span>
                                  <span class="dl">"</span><span class="s2">count</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">$count</span><span class="dl">"</span>
                              <span class="p">}</span>
                            <span class="p">}</span>
                    <span class="p">}},</span> <span class="p">{</span><span class="na">$sort</span><span class="p">:</span> <span class="p">{</span>
                      <span class="dl">"</span><span class="s2">_id.year</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span>
                    <span class="p">}}])</span>
</code></pre></div></div>

<p>It would have been a lot harder to write this query manually, without the pipeline builder.</p>

<h1 id="common-query-mistakes">Common query mistakes</h1>
<p>(<a href="https://sched.co/FmAd" target="_blank" rel="noopener noreferrer">Tips And Tricks for Avoiding Common Query Pitfalls, Christian Kurze</a>)</p>

<h3 id="key-takeaways-from-this-session">Key takeaways from this session</h3>

<p>Generally speaking, there are three major causes of query slowness:</p>
<ul>
  <li>Blocking operations</li>
  <li>Using the <code class="highlighter-rouge">$or</code> operator</li>
  <li>Case insensitive searches</li>
</ul>

<p>It’s not uncommon that a properly tuned query delivers a factor 1000 speed-up.
So it’s definitely worth investigating.</p>

<h3 id="problem-1-blocking-operations">Problem 1: blocking operations</h3>
<p>This happens when you use an operator that needs all the data before producing results, so results can’t be streamed.
The most common culprits are the aggregation operators such as <code class="highlighter-rouge">$sort</code>, <code class="highlighter-rouge">$group</code>, <code class="highlighter-rouge">$bucket</code>, <code class="highlighter-rouge">$count</code> and <code class="highlighter-rouge">$facet</code>.</p>

<p>Possible solutions:</p>
<ul>
  <li>Create a compound index to support your query and make sure that the sort order in the index is the same as in your query.</li>
  <li>Offload the query to a secondary member.</li>
  <li>Work around the issue by using a precalculated count.</li>
</ul>

<h3 id="problem-2-and-is-fast-or-is-slow">Problem 2: <code class="highlighter-rouge">$and</code> is fast, <code class="highlighter-rouge">$or</code> is slow</h3>
<p>Sometimes a query is fast when you use the <code class="highlighter-rouge">$and</code> operator but slow when you use the <code class="highlighter-rouge">$or</code> operator.</p>

<p>Solution:</p>
<ul>
  <li>Use a compound index to support <code class="highlighter-rouge">$and</code> queries.</li>
  <li>Use separate single field indexes to support <code class="highlighter-rouge">$or</code> queries.</li>
</ul>

<h3 id="problem-3-case-insensitive-searches-are-slow">Problem 3: case insensitive searches are slow!</h3>
<p>It is much harder for MongoDB to perform case insensitive searches because it has to match all possible permutations of the search string. 
For example, if you do a case insensitive search for the string “ace”, it has to match “ace”,”Ace”,”aCe”,”ACe”, and so on…</p>

<p>Solution:</p>
<ul>
  <li>(3.4 and higher) Support the query with a case insensitive index.</li>
  <li>Alternatively, store a toLower() copy of the string in another field and index and query that field instead.</li>
</ul>

<h3 id="general-tips-and-tricks">General tips and tricks</h3>
<ul>
  <li>Create an index on an element you are interested in instead of scanning the whole table.</li>
  <li>When you query on a combination of fields create a compound index for these fields and not separate indices on each field.</li>
  <li>…but be careful with the usage of <code class="highlighter-rouge">$or</code>!</li>
  <li>Build indices in the background instead of making it a blocking operation.</li>
  <li>Do not index all fields as this will negatively impact write performance. 
Investigate what you really need!</li>
  <li>Use <code class="highlighter-rouge">.explain()</code> to analyze queries.</li>
  <li>Ops Manager and Atlas have a <a href="https://docs.atlas.mongodb.com/performance-advisor/">Performance Advisor</a> to help you identify problematic queries.</li>
  <li>Train your people.</li>
  <li>Work smarter, not harder!</li>
</ul>

<h1 id="stitch">Stitch</h1>
<p>(<a href="https://sched.co/FmAJ" target="_blank" rel="noopener noreferrer">Ch-Ch-Ch-Ch-Changes: Taking Your MongoDB Stitch Application to the Next Level With Triggers, Andrew Morgan</a>)</p>
<blockquote>
  <p>Write less code and build apps faster!</p>
</blockquote>

<p>Stitch is the ‘Serverless platform from MongoDB’, and it comes with a free tier to play around!
It provides a very easy way to create an application without having to write lots of code in a separate backend.
The functionalities of Stitch are provided through an SDK.
Currently there are SDK’s for JavaScript, React Native, IOS and Android.
There is even an Electric Imp Library for IoT devices.</p>

<p>Stitch has four main services :</p>
<ul>
  <li>Stitch QueryAnywhere</li>
  <li>Stitch Functions</li>
  <li>Stitch Triggers</li>
  <li>Stitch Mobile Sync</li>
</ul>

<h3 id="stitch-queryanywhere">Stitch QueryAnywhere</h3>
<p>QueryAnywhere enables you to query the database directly instead of going through a REST api.
The benefit here is that as a client application you are not restricted to what a REST api would expose but you can use all the power of the MongoDB Query Language directly:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">employees</span> <span class="o">=</span> <span class="nx">mongodb</span><span class="p">.</span><span class="nx">db</span><span class="p">(</span><span class="dl">"</span><span class="s2">HR</span><span class="dl">"</span><span class="p">).</span><span class="nx">collection</span><span class="p">(</span><span class="dl">"</span><span class="s2">employees</span><span class="dl">"</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="nx">employees</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span>
    <span class="na">limit</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="na">sort</span><span class="p">:</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">salary</span><span class="dl">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">}</span>
  <span class="p">})</span>
    <span class="p">.</span><span class="nx">asArray</span><span class="p">();</span>
</code></pre></div></div>

<p>Of course, all of this is secured with authentication and fine grained authorization based on the logged in user or the contents of the documents.</p>

<h3 id="stitch-functions">Stitch Functions</h3>
<p>You can write JavaScript functions in the Stitch serverless platform and combine database calls with cloud services.
For example, send a message with Twilio to all users:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
 <span class="kd">var</span> <span class="nx">mongodb</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">mongodb-atlas</span><span class="dl">'</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">twilio</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">services</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">twilio</span><span class="dl">'</span><span class="p">);</span>
 <span class="kd">var</span> <span class="nx">coll</span> <span class="o">=</span> <span class="nx">mongodb</span><span class="p">.</span><span class="nx">db</span><span class="p">(</span><span class="dl">'</span><span class="s1">db</span><span class="dl">'</span><span class="p">).</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">);</span>
 <span class="k">return</span> <span class="nx">coll</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">toArray</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">users</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">users</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
   <span class="nx">twilio</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span>
    <span class="na">to</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">phone</span><span class="p">,</span>
    <span class="na">from</span><span class="p">:</span> <span class="nx">context</span><span class="p">.</span><span class="nx">values</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">twilioNumber</span><span class="dl">'</span><span class="p">),</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">message</span>
   <span class="p">});</span>
  <span class="p">});</span>
 <span class="p">});</span>
<span class="p">};</span>
<span class="err">​</span>
<span class="c1">// Then call callFunction from the client side</span>
<span class="nx">stitchClient</span><span class="p">.</span><span class="nx">callFunction</span><span class="p">(</span><span class="dl">'</span><span class="s1">sendMessage</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">Hello from Stitch!</span><span class="dl">'</span><span class="p">]);</span>
</code></pre></div></div>

<h3 id="stitch-triggers">Stitch Triggers</h3>
<p>MongoDB does not provide triggers, as known in the RDBMS world.
With MongoDB change streams you can build your own triggers in your application.
This comes with the cost of handling the complexity of change streams yourself. 
For example: how to resume the change stream after a network issue?
So that’s why there is Stitch Triggers to make this easier.</p>

<p>Stitch triggers combines change streams with Stitch Functions.
So when the inventory of an article goes up, Stitch Trigger calls a function that uses Twilio to send a text message to your client.</p>

<h3 id="stitch-mobile-sync">Stitch Mobile Sync</h3>
<p>Since 4.0, MongoDB provides a <a href="https://www.mongodb.com/products/mobile" target="_blank" rel="noopener noreferrer">Mobile</a> version for IOS and Android.
With Stitch, you can sync your data in your mobile application with your database.
So now you can use the full MongoDB Query Language, including aggregations, on your mobile device and sync it with your database.</p>

<h3 id="built-in-external-integrations">Built-in external Integrations</h3>
<p>The fun with Stitch really starts when you combine all the goodness of Stitch with its integrations with cloud services like Twilio, AWS, Google, etc…
You can authenticate with Google, store files on S3 or spin up a cluster on Redshift after you send a text message with Twilio.
All of this can be hidden behind a simple function call for your application, or a trigger on your Atlas cluster.</p>

<h3 id="limited-to-stitch-ui">Limited to Stitch UI?</h3>
<p>Luckily MongoDB builds its products with developers in mind.
So you can import and export your Stitch applications and put them in a source control of your choice.</p>

<h1 id="meet-the-experts">Meet the experts</h1>
<p>At the conference you had the chance to book a 20 minute session with a MongoDB expert.
This was of great help in getting to know the new MongoDB Aggregation Pipeline builder.
The expert also gave some more tips in “thinking noSQL”.</p>

<blockquote>
  <p>When data is shown together it is stored together – MongoDB expert</p>
</blockquote>

<blockquote>
  <p>Data should be stored in the same way it is used – MongoDB expert</p>
</blockquote>

<h1 id="streaming-data-pipelines-with-mongodb-and-kafka-at-ao"><a href="https://sched.co/FmAp" target="_blank" rel="noopener noreferrer">Streaming data pipelines with MongoDB and Kafka at AO</a></h1>
<p>Appliances Online, <a href="https://ao.com/" target="_blank" rel="noopener noreferrer">AO</a>, is an international online appliances retailer.
They wanted to solve the issue of having data locked in different places so they wanted a <a href="https://en.wikipedia.org/wiki/Single_customer_view/" target="_blank" rel="noopener noreferrer">Single Customer View</a>.
The idea was to get the data from all the different places and consolidate this in MongoDB.
We are talking here about data stored in legacy databases or messages going through queues.
The data could be the usual customer data and phone calls with customer care.
But also about parcels moving through the warehouse and delivery tracking.
They wanted to get the data while it’s hot, not in hourly or daily (or worse…) batches.
It was decided to use MongoDB to build up this materialised view of all different data streams, and Atlas to be able to focus on the application and not the database administration.</p>

<p>The vast majority of the data resides in MsSql databases.
Extraction happens with <a href="https://www.confluent.io/connector/kafka-connect-cdc-microsoft-sql/">Kafka Connect SQL CDC</a> to generate a stream of all create, update and delete operations into a stream, and push it to Kafka.<br />
All with a simple piece of configuration like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"msSqlSourceConnector1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"config"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"connector.class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"io.confluent.connect.cdc.mssql.MsSqlSourceConnector"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tasks.max"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"initial.database"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"testing"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"username"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"cdc"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"password"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"server.name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"db-01.example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"server.port"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1433"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>They use Avro for the schema definition in combination with a schema-registry.
Interested clients can then read the data off the topics and do their single-view-thing on the data and save it to MongoDB.
The view is being built up, message per message.
Afterwards this view in  MongoDB is then pushed back to Kafka as another stream to provide this data to interested parties.
This avoids locking the data in one place.</p>

<p>To finish it of they shared some lessons learned :</p>
<ul>
  <li>Watch out for frameworks generating queries.<br />
 They can create bad performing aggregations or queries.<br />
 For them it was better to write some queries explicitly.</li>
  <li>Use custom _id for unique determination of your model, it saves an index and RAM</li>
  <li>Watch out for unbounded document growth.</li>
</ul>

<h1 id="mongodb-enterprise-operator-for-kubernetes-at-amadeus"><a href="https://sched.co/FmAc" target="_blank" rel="noopener noreferrer">MongoDB Enterprise Operator for Kubernetes at Amadeus</a></h1>

<p><a href="https://amadeus.com/en">Amadeus</a> is the world’s largest technology company dedicated to the travel industry.
They have developed an impressive MongoDB farm, a large environment with 100 clusters.
Some of these clusters run more than 100 shards, while others have 100TB MongoDB databases.
Amadeus processes more than 1 trillion flight availability requests per day. 
For each single search you do on a website they receive 500.000 availability requests.
So search responsibly ;-)
The number of requests per day grows by 50% each year.
The second of January has by far the most requests, due to new years resolutions!
If this day is in the weekend all systems are pushed to their limits.
The airline fare database for one of their big clients, Kayak, is 100TB in size and changes daily.
That’s some pretty big numbers there.
No wonder that Amadeus is a happy user of the MongoDB Enterprise Operator for Kubernetes.</p>

<p>Starting with the MongoDB Ops Manager v4.0, MongoDB officially supports the management and deployment of MongoDB in Kubernetes with Backup, Automation, Alerting and Monitoring.
A <a href="https://github.com/mongodb/mongodb-enterprise-kubernetes">MongoDB Enterprise Kubernetes Operator</a> has app-specific awareness about stateful applications, so it knows how to deploy them.
This operator helps automating scripted tasks and enables MongoDB-as-a-service for developers.
It talks to Ops Manager and delegates the creation of clusters, shards, backups and automation to Ops Manager.
The underlying necessary Kubernetes infrastructure is orchestrated by the operator itself and so they work in conjunction.
This provides for clusters to be setup, scaled up/down/out/in, with a single simple yaml file.
And kubernetes provides the self-healing capabilities, how nice is that!?</p>

<p>The following yaml file is all you need to spin up a 3 node replica set :</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">mongodb.com/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">MongoDbReplicaSet</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myReplicaSet</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">mongodb</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">members</span><span class="pi">:</span> <span class="m">3</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s">4.0.1</span>

  <span class="na">project</span><span class="pi">:</span> <span class="s">projectName</span>
  <span class="na">credentials</span><span class="pi">:</span> <span class="s">myUberSecretCredentials</span>
</code></pre></div></div>

<p>I kid you not, that’s it.</p>

<p>Scale out or back in with a simple change in the config yaml and</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cubectl apply <span class="nt">-f</span> file.yaml
</code></pre></div></div>

<h1 id="mongodb-charts">MongoDB Charts</h1>
<ul>
  <li><a href="https://sched.co/FtWP">Bringing Data to Life with MongoDB Charts</a>, Guillaume Meister.</li>
</ul>

<p>Currently, if you want to visualize data in a MongoDB database you either have to code it yourself, or rely on a 3rd party tool and migrate your data to a different platform (for example: Kibana with Elasticsearch is very popular).
Needless to say that this can be quite cumbersome.
<a href="https://www.mongodb.com/products/charts">MongoDB Charts</a> intends to solve this.</p>

<p>So what is it? 
MongoDB Charts is a visualization tool that runs as a standalone webserver so you can access it via a web browser.</p>

<p>In Charts you define data sources by pointing to a collection or view on a MongoDB instance.
Then you can create all kinds of visualizations based on the data source, using various aggregation and filter functions.
Finally, you can combine charts into dashboards with a customized layout and you can share these with other users.</p>

<p>A picture is worth a thousand words, so to give you a better idea of what it is all about, let’s look at an animation of Charts in action:</p>

<div style="text-align: center;">
  <img src="/img/2018-11-08-mongodb-europe-2018/mongodb-charts-01.gif" width="100%" />
</div>

<p>Charts is still in beta but you can already try it out. 
MongoDB provides a docker image that you can <a href="https://www.mongodb.com/download-center/charts">download</a> via the MongoDB download center.</p>

<h1 id="closing">Closing</h1>
<p>It was a great day being submerged in MongoDB-knowledge. 
This conference gave us plenty of opportunity to talk to other experts and learn about the new and upcoming features.</p>

<p>Keep an eye on this space for more MongoDB goodness.</p>


        </div>
    </div>
    <div class="share-page" >
        <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://ordina-jworks.github.io/development/2018/11/20/mongodb-europe-018.html&title=MongoDB Europe 2018&source=https://ordina-jworks.github.io" rel="nofollow" target="_blank" title="Share on LinkedIN">
            <img src="/img/social-media/LinkedIn.png"
                 alt="Share on LinkedIn" />
        </a>
        <a href="https://twitter.com/intent/tweet?text=MongoDB Europe 2018&url=https://ordina-jworks.github.io/development/2018/11/20/mongodb-europe-018.html&via=lifeatordinabe&related=lifeatordinabe" rel="nofollow" target="_blank" title="Share on Twitter">
            <img src="/img/social-media/Twitter.png"
                 alt="Share on Twitter" />
        </a>
        <a href="https://facebook.com/sharer.php?u=https://ordina-jworks.github.io/development/2018/11/20/mongodb-europe-018.html" rel="nofollow" target="_blank" title="Share on Facebook">
            <img src="/img/social-media/Facebook.png"
                 alt="Share on Facebook" />
        </a>
    </div>
        
</section>


<section id="two" class="wrapper alt spotlight style2">
    
    <div class="inner">
        <a href="/author/chris-de-bruyne" class="image spotlight-image" title="">
            <img src="/img/author/chris-de-bruyne.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Chris is a Senior Java Developer at Ordina Belgium, passionate about Java and MongoDB. Chris is passionate to help colleagues and clients to get the most out of MongoDB and the Java eco system.</p>
</p>
            
        </div>
    </div>
    
    <div class="inner">
        <a href="/author/nick-van-hoof" class="image spotlight-image" title="">
            <img src="/img/author/nick-van-hoof.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Nick is passionate about cloud technology. He has major expertise in AWS and AWS serverless but he appreciates other clouds just as well. He wants to be ahead of change and thus he’s also working with IoT and AI.</p>
</p>
            
        </div>
    </div>
    
    <div class="inner">
        <a href="/author/jan-van-der-veken/" class="image spotlight-image" title="">
            <img src="/img/author/no-image.jpg"
                 alt="" class="p-image"/>
        </a>

        <div class="content">
            
            <p><p>Jan is a database specialist with many years of experience as system engineer and Oracle DBA, and who is now focusing on cloud and nosql technologies such as MongoDB and the Elastic stack.</p>
</p>
            
        </div>
    </div>
    
</section>

        </div>
    </section>
</div>



<footer>
    <div class="contact">
        <div class="address">
            <div class="icon"><i class="fa fa-fw fa-home"></i></div>
            <div class="text">Ordina Belgium<br/>Blarenberglaan 3B,<br/>2800 Mechelen, Belgium</div>
        </div>
        <div class="phone">
            <div class="icon"><i class="fa fa-fw fa-phone"></i></div>
            <div class="text"><a href="tel:003215295858">+32 15 29 58 58</a></div>
        </div>
        <div class="email">
            <div class="icon"><i class="fa fa-fw fa-envelope-o"></i></div>
            <div class="text"><a href="mailto:jworks@ordina.be">jworks@ordina.be</a></div>
        </div>
    </div>
    <ul class="social">
        <li>
            <a href="https://twitter.com/lifeatordinabe" target="_blank">
                <i class="fa fa-fw fa-twitter"></i><span>Twitter</span>
            </a>
        </li>
        <li>
            <a href="https://www.facebook.com/lifeatordinabe" target="_blank">
                <i class=" fa fa-fw fa-facebook"></i><span>Facebook</span>
            </a>
        </li>
        <li>
            <a href="https://www.linkedin.com/company/ordina-belgium" target="_blank">
                <i class=" fa fa-fw fa-linkedin"></i><span>LinkedIn</span>
            </a>
        </li>
        <li>
            <a href="https://plus.google.com/113222464071666722451" target="_blank">
                <i class=" fa fa-fw fa-google-plus"></i><span>Google+</span>
            </a>
        </li>
        <li>
            <a href="/youtube" target="_blank">
                <i class=" fa fa-fw fa-youtube"></i><span>YouTube</span>
            </a>
        </li>
        <li>
            <a href="/github" target="_blank">
                <i class=" fa fa-fw fa-github"></i><span>GitHub</span>
            </a>
        </li>
        <li>
            <a href="/feed.xml" target="_blank">
                <i class=" fa fa-fw fa-rss"></i><span>RSS Feed</span>
            </a>
        </li>
    </ul>
    <div class="copyright">
        &copy; 2019 Ordina JWorks. All rights reserved.
        <br /> Disclaimer: Opinions expressed on this blog reflect the writer's views and not the position of Ordina
        <img id="analyticsImg" src="" width="1" height="1" style="border: 0px"/>
    </div>
</footer>
<!-- Scripts -->
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.scrollex.min.js"></script>
<script src="/js/jquery.magnific-popup.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/skel.min.js"></script>
<script src="/js/jquery.pin.min.js"></script>
<script src="/js/util.js"></script>
<!--[if lte IE 8]>
<script src="/js/ie/respond.min.js"></script><![endif]-->


<script>
    var imageHref = "/img/2018-11-08-mongodb-europe-2018/main-image-mdbe.png";
    $(function () {
        $('body').addClass('toggle');
    });
</script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o);
        m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-70040502-1', 'auto');
    ga('send', 'pageview');
</script>
<script type="text/javascript">
    window.addEventListener('load', function () {
        if (window.ga && ga.create) {
            console.log('GA loaded correctly');
        } else {
            console.log('GA is blocked or failed to load - tracking manually...')
            document.getElementById('analyticsImg').src = 'https://jworks-techblog-analytics.cfapps.io/collect?title=' + document.title;
        }
    }, false);
</script>

<!-- Vertical timeline -->
<script src="/js/vertical-timeline/modernizr.js"></script>
<script src="/js/vertical-timeline/main.js"></script>


</body>
</html>
