---
layout: post
authors: [yolan_vloeberghs, pieter_vincken]
title: 'KubeCon + CloudNativeCon 2023'
image: /img/2022-05-20-kubecon/kccnc-eu-2022-color-resized.png
tags: [cloud, conference, cloud-native, kubernetes]
category: Cloud
comments: true
---
# Introduction
TODO: replace banner & add group picture

# Talk 1
# Talk 2

## Metrics at Full Throttle: Intro and Deep Dive Into Thanos - Saswata Mukherjee & Filip Petkovski, Shopify

Thanos enables a highly available Prometheus setup.
It replaces parts of the Prometheus deployment model that are hard to scale with regular Prometheus. 

This talk is a great introduction to Thanos.
Saswata and Filip start by explaining what difficulties you can have with scaling a regular Prometheus setup. 
They explain what components of Thanos solve the different issues with scaling Prometheus. 
The following components of Thanos are introduced: Sidecar, Ruler, Receive, Query, Compactor and Store gateway.

Where the first half of the talk is mainly targeted towards people who don't know Thanos or don't know all capabilities of Thanos yet, the second half was surely targeted towards experienced Thanos users.
In the second half of the talk, Saswata and Filip highlight recent, since the KubeCon Detroit, improvements to Thanos.

They discuss 5 new features in Thanos. 
The first boils down to optimizations to the store gateway to remove the high IO requirements to run the store gateway.
The new store gateway implementation doesn't require the high IO disk anymore as the information is stored in memory instead of on disk. 

Three new features were announced to optimise the querying throughout the different components in Thanos.

First, quality of service limits were added as Thanos configuration options. 
This allows teams managing Thanos to define the limits to tune the Thanos performance and prevent a single query from overloading the system.

The second improvement related to query performance was a newly implemented, Thanos-specific, PromQL engine. 
With the new query engine, the query will be analyzed up front and an optimal (parallel!) execution will be determined. 
Since not all operators are supported yet, the new engine will be used when possible with a fallback to the standard Prometheus PromQL engine when needed.

The third improvement is the distributed execution of queries.
This mechanism allows queries to be executed by the nodes that have direct access to the needed data, preventing costly data transfers between components in the Thanos architecture. 
If you want more information on this amazing feature, definitely check out this talk when it's available on YouTube!

A new hash ring mechanism was implemented for the Receiver to prevent overloading single Receiver instances. 

They end by showing real-world performance graphs from the Thanos deployment at Shopify and how different versions of Thanos caused visible improvements.